(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65f546f0"],{"057f":function(t,i,o){var n=o("fc6a"),e=o("241c").f,s={}.toString,r="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],l=function(t){try{return e(t)}catch(i){return r.slice()}};t.exports.f=function(t){return r&&"[object Window]"==s.call(t)?l(t):e(n(t))}},"1dde":function(t,i,o){var n=o("d039"),e=o("b622"),s=o("2d00"),r=e("species");t.exports=function(t){return s>=51||!n((function(){var i=[],o=i.constructor={};return o[r]=function(){return{foo:1}},1!==i[t](Boolean).foo}))}},"25f0":function(t,i,o){"use strict";var n=o("6eeb"),e=o("825a"),s=o("d039"),r=o("ad6d"),l="toString",a=RegExp.prototype,m=a[l],_=s((function(){return"/a/b"!=m.call({source:"a",flags:"b"})})),h=m.name!=l;(_||h)&&n(RegExp.prototype,l,(function(){var t=e(this),i=String(t.source),o=t.flags,n=String(void 0===o&&t instanceof RegExp&&!("flags"in a)?r.call(t):o);return"/"+i+"/"+n}),{unsafe:!0})},5899:function(t,i){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,i,o){var n=o("1d80"),e=o("5899"),s="["+e+"]",r=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),a=function(t){return function(i){var o=String(n(i));return 1&t&&(o=o.replace(r,"")),2&t&&(o=o.replace(l,"")),o}};t.exports={start:a(1),end:a(2),trim:a(3)}},"65f0":function(t,i,o){var n=o("861d"),e=o("e8b5"),s=o("b622"),r=s("species");t.exports=function(t,i){var o;return e(t)&&(o=t.constructor,"function"!=typeof o||o!==Array&&!e(o.prototype)?n(o)&&(o=o[r],null===o&&(o=void 0)):o=void 0),new(void 0===o?Array:o)(0===i?0:i)}},"6db0":function(t,i,o){"use strict";o.r(i);var n=function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("div",{staticClass:"ballanimation"},[o("div",{staticStyle:{"text-align":"center"}},[t.isBallStart?t._e():o("button",{staticClass:"layui-btn layui-btn-primary layui-border",attrs:{id:"start",title:"休闲益智小游戏:碰撞球"},on:{click:t.isStartChange}},[t._v("休闲益智小游戏:碰撞球")]),o("br"),o("span",{staticStyle:{color:"#FFFFFF"},attrs:{name:"tips",title:"鼠标左键放置,双击重置;鼠标右键退出"}},[t._v("鼠标左键放置,双击重置;鼠标右键退出")]),o("br"),o("span",{staticStyle:{"font-size":"1px",color:"#FFFFFF"},attrs:{title:"非电脑用户退出请刷新页面"}},[t._v("非电脑用户退出请刷新页面")])]),o("div",{attrs:{id:"canvas"}})])},e=[];o("a4d3"),o("e01a"),o("d3b7"),o("d28b"),o("3ca3"),o("ddb0");function s(t){return s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}o("b64b"),o("25f0"),o("bf19"),o("a15b"),o("a434");var r=function(){var t={create:function(){var o=null,n=i(arguments);function e(){this.initialize.apply(this,arguments)}if(Object.isFunction(n[0])&&(o=n.shift()),Object.extend(e,t.Methods),e.superclass=o,e.subclasses=[],o){var s=function(){};s.prototype=o.prototype,e.prototype=new s,o.subclasses.push(e)}for(var r=0;r<n.length;r++)e.addMethods(n[r]);return e.prototype.initialize||(e.prototype.initialize=this.emptyFunction),e.prototype.constructor=e,e},emptyFunction:function(){}};function i(t){if(!t)return[];if(t.toArray)return t.toArray();var i=t.length||0,o=new Array(i);while(i--)o[i]=t[i];return o}t.Methods={addMethods:function(t){var i=this.superclass&&this.superclass.prototype,o=Object.keys(t);Object.keys({toString:!0}).length||o.push("toString","valueOf");for(var n=0,e=o.length;n<e;n++){var s=o[n],r=t[s];if(i&&Object.isFunction(r)&&"$super"==r.argumentNames().first()){var l=r;r=Object.extend(function(t){return function(){return i[t].apply(this,arguments)}}(s).wrap(l),{valueOf:function(){return l},toString:function(){return l.toString()}})}this.prototype[s]=r}return this}},Object.extend=function(t,i){for(var o in i)t[o]=i[o];return t},Object.extend(Object,{inspect:function(t){try{return Object.isUndefined(t)?"undefined":null===t?"null":t.inspect?t.inspect():String(t)}catch(i){if(i instanceof RangeError)return"...";throw i}},toJSON:function(t){var i=s(t);switch(i){case"undefined":case"function":case"unknown":return;case"boolean":return t.toString()}if(null===t)return"null";if(t.toJSON)return t.toJSON();if(!Object.isElement(t)){var o=[];for(var n in t){var e=Object.toJSON(t[n]);Object.isUndefined(e)||o.push(n.toJSON()+": "+e)}return"{"+o.join(", ")+"}"}},toQueryString:function(t){return $H(t).toQueryString()},toHTML:function(t){return t&&t.toHTML?t.toHTML():String.interpret(t)},keys:function(t){var i=[];for(var o in t)i.push(o);return i},values:function(t){var i=[];for(var o in t)i.push(t[o]);return i},clone:function(t){return Object.extend({},t)},isElement:function(t){return t&&1==t.nodeType},isArray:function(t){return null!=t&&"object"==s(t)&&"splice"in t&&"join"in t},isHash:function(t){return t instanceof Hash},isFunction:function(t){return"function"==typeof t},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isUndefined:function(t){return"undefined"==typeof t}});return navigator.userAgent.indexOf("AppleWebKit/")>-1&&(i=function(t){if(!t)return[];if((!Object.isFunction(t)||"[object NodeList]"!=t)&&t.toArray)return t.toArray();var i=t.length||0,o=new Array(i);while(i--)o[i]=t[i];return o}),t},l=(o("a9e3"),r()),a=function(){var t=l.create();t.prototype={initialize:function(){}},t.USHRT_MAX=65535,t.b2_pi=Math.PI,t.b2_massUnitsPerKilogram=1,t.b2_timeUnitsPerSecond=1,t.b2_lengthUnitsPerMeter=30,t.b2_maxManifoldPoints=2,t.b2_maxShapesPerBody=64,t.b2_maxPolyVertices=8,t.b2_maxProxies=1024,t.b2_maxPairs=8*t.b2_maxProxies,t.b2_linearSlop=.005*t.b2_lengthUnitsPerMeter,t.b2_angularSlop=2/180*t.b2_pi,t.b2_velocityThreshold=1*t.b2_lengthUnitsPerMeter/t.b2_timeUnitsPerSecond,t.b2_maxLinearCorrection=.2*t.b2_lengthUnitsPerMeter,t.b2_maxAngularCorrection=8/180*t.b2_pi,t.b2_contactBaumgarte=.2,t.b2_timeToSleep=.5*t.b2_timeUnitsPerSecond,t.b2_linearSleepTolerance=.01*t.b2_lengthUnitsPerMeter/t.b2_timeUnitsPerSecond,t.b2_angularSleepTolerance=2/180/t.b2_timeUnitsPerSecond,t.b2Assert=function(t){var i;t||i.x++};var i=l.create();i.prototype={initialize:function(t,i){this.x=t,this.y=i},SetZero:function(){this.x=0,this.y=0},Set:function(t,i){this.x=t,this.y=i},SetV:function(t){this.x=t.x,this.y=t.y},Negative:function(){return new i(-this.x,-this.y)},Copy:function(){return new i(this.x,this.y)},Add:function(t){this.x+=t.x,this.y+=t.y},Subtract:function(t){this.x-=t.x,this.y-=t.y},Multiply:function(t){this.x*=t,this.y*=t},MulM:function(t){var i=this.x;this.x=t.col1.x*i+t.col2.x*this.y,this.y=t.col1.y*i+t.col2.y*this.y},MulTM:function(t){var i=n.b2Dot(this,t.col1);this.y=n.b2Dot(this,t.col2),this.x=i},CrossVF:function(t){var i=this.x;this.x=t*this.y,this.y=-t*i},CrossFV:function(t){var i=this.x;this.x=-t*this.y,this.y=t*i},MinV:function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},MaxV:function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},Abs:function(){this.x=Math.abs(this.x),this.y=Math.abs(this.y)},Length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Normalize:function(){var t=this.Length();if(t<Number.MIN_VALUE)return 0;var i=1/t;return this.x*=i,this.y*=i,t},IsValid:function(){return n.b2IsValid(this.x)&&n.b2IsValid(this.y)},x:null,y:null},i.Make=function(t,o){return new i(t,o)};var o=l.create();o.prototype={initialize:function(t,o,n){if(null==t&&(t=0),this.col1=new i,this.col2=new i,null!=o&&null!=n)this.col1.SetV(o),this.col2.SetV(n);else{var e=Math.cos(t),s=Math.sin(t);this.col1.x=e,this.col2.x=-s,this.col1.y=s,this.col2.y=e}},Set:function(t){var i=Math.cos(t),o=Math.sin(t);this.col1.x=i,this.col2.x=-o,this.col1.y=o,this.col2.y=i},SetVV:function(t,i){this.col1.SetV(t),this.col2.SetV(i)},Copy:function(){return new o(0,this.col1,this.col2)},SetM:function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},AddM:function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},SetIdentity:function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},SetZero:function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},Invert:function(t){var i=this.col1.x,o=this.col2.x,n=this.col1.y,e=this.col2.y,s=i*e-o*n;return s=1/s,t.col1.x=s*e,t.col2.x=-s*o,t.col1.y=-s*n,t.col2.y=s*i,t},Solve:function(t,i,o){var n=this.col1.x,e=this.col2.x,s=this.col1.y,r=this.col2.y,l=n*r-e*s;return l=1/l,t.x=l*(r*i-e*o),t.y=l*(n*o-s*i),t},Abs:function(){this.col1.Abs(),this.col2.Abs()},col1:new i,col2:new i};var n=l.create();n.prototype={initialize:function(){}},n.b2IsValid=function(t){return isFinite(t)},n.b2Dot=function(t,i){return t.x*i.x+t.y*i.y},n.b2CrossVV=function(t,i){return t.x*i.y-t.y*i.x},n.b2CrossVF=function(t,o){var n=new i(o*t.y,-o*t.x);return n},n.b2CrossFV=function(t,o){var n=new i(-t*o.y,t*o.x);return n},n.b2MulMV=function(t,o){var n=new i(t.col1.x*o.x+t.col2.x*o.y,t.col1.y*o.x+t.col2.y*o.y);return n},n.b2MulTMV=function(t,o){var e=new i(n.b2Dot(o,t.col1),n.b2Dot(o,t.col2));return e},n.AddVV=function(t,o){var n=new i(t.x+o.x,t.y+o.y);return n},n.SubtractVV=function(t,o){var n=new i(t.x-o.x,t.y-o.y);return n},n.MulFV=function(t,o){var n=new i(t*o.x,t*o.y);return n},n.AddMM=function(t,i){var e=new o(0,n.AddVV(t.col1,i.col1),n.AddVV(t.col2,i.col2));return e},n.b2MulMM=function(t,i){var e=new o(0,n.b2MulMV(t,i.col1),n.b2MulMV(t,i.col2));return e},n.b2MulTMM=function(t,e){var s=new i(n.b2Dot(t.col1,e.col1),n.b2Dot(t.col2,e.col1)),r=new i(n.b2Dot(t.col1,e.col2),n.b2Dot(t.col2,e.col2)),l=new o(0,s,r);return l},n.b2Abs=function(t){return t>0?t:-t},n.b2AbsV=function(t){var o=new i(n.b2Abs(t.x),n.b2Abs(t.y));return o},n.b2AbsM=function(t){var i=new o(0,n.b2AbsV(t.col1),n.b2AbsV(t.col2));return i},n.b2Min=function(t,i){return t<i?t:i},n.b2MinV=function(t,o){var e=new i(n.b2Min(t.x,o.x),n.b2Min(t.y,o.y));return e},n.b2Max=function(t,i){return t>i?t:i},n.b2MaxV=function(t,o){var e=new i(n.b2Max(t.x,o.x),n.b2Max(t.y,o.y));return e},n.b2Clamp=function(t,i,o){return n.b2Max(i,n.b2Min(t,o))},n.b2ClampV=function(t,i,o){return n.b2MaxV(i,n.b2MinV(t,o))},n.b2Swap=function(t,i){var o=t[0];t[0]=i[0],i[0]=o},n.b2Random=function(){return 2*Math.random()-1},n.b2NextPowerOfTwo=function(t){return t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,t|=t>>16&65535,t+1},n.b2IsPowerOfTwo=function(t){var i=t>0&&0==(t&t-1);return i},n.tempVec2=new i,n.tempVec3=new i,n.tempVec4=new i,n.tempVec5=new i,n.tempMat=new o;var e=l.create();e.prototype={IsValid:function(){var t=this.maxVertex.x,i=this.maxVertex.y;t=this.maxVertex.x,i=this.maxVertex.y,t-=this.minVertex.x,i-=this.minVertex.y;var o=t>=0&&i>=0;return o=o&&this.minVertex.IsValid()&&this.maxVertex.IsValid(),o},minVertex:new i,maxVertex:new i,initialize:function(){this.minVertex=new i,this.maxVertex=new i}};var s=l.create();s.prototype={IsLower:function(){return 0==(1&this.value)},IsUpper:function(){return 1==(1&this.value)},Swap:function(t){var i=this.value,o=this.proxyId,n=this.stabbingCount;this.value=t.value,this.proxyId=t.proxyId,this.stabbingCount=t.stabbingCount,t.value=i,t.proxyId=o,t.stabbingCount=n},value:0,proxyId:0,stabbingCount:0,initialize:function(){}};var r=l.create();r.prototype={lowerValues:[0,0],upperValues:[0,0],initialize:function(){this.lowerValues=[0,0],this.upperValues=[0,0]}};var a=l.create();a.prototype={SetBuffered:function(){this.status|=a.e_pairBuffered},ClearBuffered:function(){this.status&=~a.e_pairBuffered},IsBuffered:function(){return(this.status&a.e_pairBuffered)==a.e_pairBuffered},SetRemoved:function(){this.status|=a.e_pairRemoved},ClearRemoved:function(){this.status&=~a.e_pairRemoved},IsRemoved:function(){return(this.status&a.e_pairRemoved)==a.e_pairRemoved},SetFinal:function(){this.status|=a.e_pairFinal},IsFinal:function(){return(this.status&a.e_pairFinal)==a.e_pairFinal},userData:null,proxyId1:0,proxyId2:0,next:0,status:0,initialize:function(){}},a.b2_nullPair=t.USHRT_MAX,a.b2_nullProxy=t.USHRT_MAX,a.b2_tableCapacity=t.b2_maxPairs,a.b2_tableMask=a.b2_tableCapacity-1,a.e_pairBuffered=1,a.e_pairRemoved=2,a.e_pairFinal=4;var m=l.create();m.prototype={PairAdded:function(t,i){return null},PairRemoved:function(t,i,o){},initialize:function(){}};var _=l.create();_.prototype={proxyId1:0,proxyId2:0,initialize:function(){}};var h=l.create();h.prototype={initialize:function(){var i=0;for(this.m_hashTable=new Array(a.b2_tableCapacity),i=0;i<a.b2_tableCapacity;++i)this.m_hashTable[i]=a.b2_nullPair;for(this.m_pairs=new Array(t.b2_maxPairs),i=0;i<t.b2_maxPairs;++i)this.m_pairs[i]=new a;for(this.m_pairBuffer=new Array(t.b2_maxPairs),i=0;i<t.b2_maxPairs;++i)this.m_pairBuffer[i]=new _;for(i=0;i<t.b2_maxPairs;++i)this.m_pairs[i].proxyId1=a.b2_nullProxy,this.m_pairs[i].proxyId2=a.b2_nullProxy,this.m_pairs[i].userData=null,this.m_pairs[i].status=0,this.m_pairs[i].next=i+1;this.m_pairs[t.b2_maxPairs-1].next=a.b2_nullPair,this.m_pairCount=0},Initialize:function(t,i){this.m_broadPhase=t,this.m_callback=i},AddBufferedPair:function(t,i){var o=this.AddPair(t,i);0==o.IsBuffered()&&(o.SetBuffered(),this.m_pairBuffer[this.m_pairBufferCount].proxyId1=o.proxyId1,this.m_pairBuffer[this.m_pairBufferCount].proxyId2=o.proxyId2,++this.m_pairBufferCount),o.ClearRemoved(),c.s_validate&&this.ValidateBuffer()},RemoveBufferedPair:function(t,i){var o=this.Find(t,i);null!=o&&(0==o.IsBuffered()&&(o.SetBuffered(),this.m_pairBuffer[this.m_pairBufferCount].proxyId1=o.proxyId1,this.m_pairBuffer[this.m_pairBufferCount].proxyId2=o.proxyId2,++this.m_pairBufferCount),o.SetRemoved(),c.s_validate&&this.ValidateBuffer())},Commit:function(){var t=0,i=0,o=this.m_broadPhase.m_proxyPool;for(t=0;t<this.m_pairBufferCount;++t){var n=this.Find(this.m_pairBuffer[t].proxyId1,this.m_pairBuffer[t].proxyId2);n.ClearBuffered();var e=o[n.proxyId1],s=o[n.proxyId2];n.IsRemoved()?(1==n.IsFinal()&&this.m_callback.PairRemoved(e.userData,s.userData,n.userData),this.m_pairBuffer[i].proxyId1=n.proxyId1,this.m_pairBuffer[i].proxyId2=n.proxyId2,++i):0==n.IsFinal()&&(n.userData=this.m_callback.PairAdded(e.userData,s.userData),n.SetFinal())}for(t=0;t<i;++t)this.RemovePair(this.m_pairBuffer[t].proxyId1,this.m_pairBuffer[t].proxyId2);this.m_pairBufferCount=0,c.s_validate&&this.ValidateTable()},AddPair:function(t,i){if(t>i){var o=t;t=i,i=o}var n=h.Hash(t,i)&a.b2_tableMask,e=e=this.FindHash(t,i,n);if(null!=e)return e;var s=this.m_freePair;return e=this.m_pairs[s],this.m_freePair=e.next,e.proxyId1=t,e.proxyId2=i,e.status=0,e.userData=null,e.next=this.m_hashTable[n],this.m_hashTable[n]=s,++this.m_pairCount,e},RemovePair:function(t,i){if(t>i){var o=t;t=i,i=o}var n=h.Hash(t,i)&a.b2_tableMask,e=this.m_hashTable[n],s=null;while(e!=a.b2_nullPair){if(h.Equals(this.m_pairs[e],t,i)){var r=e;s?s.next=this.m_pairs[e].next:this.m_hashTable[n]=this.m_pairs[e].next;var l=this.m_pairs[r],m=l.userData;return l.next=this.m_freePair,l.proxyId1=a.b2_nullProxy,l.proxyId2=a.b2_nullProxy,l.userData=null,l.status=0,this.m_freePair=r,--this.m_pairCount,m}s=this.m_pairs[e],e=s.next}return null},Find:function(t,i){if(t>i){var o=t;t=i,i=o}var n=h.Hash(t,i)&a.b2_tableMask;return this.FindHash(t,i,n)},FindHash:function(t,i,o){var n=this.m_hashTable[o];while(n!=a.b2_nullPair&&0==h.Equals(this.m_pairs[n],t,i))n=this.m_pairs[n].next;return n==a.b2_nullPair?null:this.m_pairs[n]},ValidateBuffer:function(){},ValidateTable:function(){},m_broadPhase:null,m_callback:null,m_pairs:null,m_freePair:0,m_pairCount:0,m_pairBuffer:null,m_pairBufferCount:0,m_hashTable:null},h.Hash=function(t,i){var o=i<<16&4294901760|t;return o=~o+(o<<15&4294934528),o^=o>>12&1048575,o+=o<<2&4294967292,o^=o>>4&268435455,o*=2057,o^=o>>16&65535,o},h.Equals=function(t,i,o){return t.proxyId1==i&&t.proxyId2==o},h.EqualsPair=function(t,i){return t.proxyId1==i.proxyId1&&t.proxyId2==i.proxyId2};var c=l.create();c.prototype={initialize:function(o,n){this.m_pairManager=new h,this.m_proxyPool=new Array(t.b2_maxPairs),this.m_bounds=new Array(2*t.b2_maxProxies),this.m_queryResults=new Array(t.b2_maxProxies),this.m_quantizationFactor=new i;var e=0;for(this.m_pairManager.Initialize(this,n),this.m_worldAABB=o,this.m_proxyCount=0,e=0;e<t.b2_maxProxies;e++)this.m_queryResults[e]=0;for(this.m_bounds=new Array(2),e=0;e<2;e++){this.m_bounds[e]=new Array(2*t.b2_maxProxies);for(var r=0;r<2*t.b2_maxProxies;r++)this.m_bounds[e][r]=new s}var l,m=o.maxVertex.x,_=o.maxVertex.y;for(m-=o.minVertex.x,_-=o.minVertex.y,this.m_quantizationFactor.x=t.USHRT_MAX/m,this.m_quantizationFactor.y=t.USHRT_MAX/_,e=0;e<t.b2_maxProxies-1;++e)l=new g,this.m_proxyPool[e]=l,l.SetNext(e+1),l.timeStamp=0,l.overlapCount=c.b2_invalid,l.userData=null;l=new g,this.m_proxyPool[t.b2_maxProxies-1]=l,l.SetNext(a.b2_nullProxy),l.timeStamp=0,l.overlapCount=c.b2_invalid,l.userData=null,this.m_freeProxy=0,this.m_timeStamp=1,this.m_queryResultCount=0},InRange:function(t){var i,o,e,s;return i=t.minVertex.x,o=t.minVertex.y,i-=this.m_worldAABB.maxVertex.x,o-=this.m_worldAABB.maxVertex.y,e=this.m_worldAABB.minVertex.x,s=this.m_worldAABB.minVertex.y,e-=t.maxVertex.x,s-=t.maxVertex.y,i=n.b2Max(i,e),o=n.b2Max(o,s),n.b2Max(i,o)<0},GetProxy:function(t){return t==a.b2_nullProxy||0==this.m_proxyPool[t].IsValid()?null:this.m_proxyPool[t]},CreateProxy:function(t,i){var o,n=0,e=this.m_freeProxy;o=this.m_proxyPool[e],this.m_freeProxy=o.GetNext(),o.overlapCount=0,o.userData=i;var r=2*this.m_proxyCount,l=new Array,a=new Array;this.ComputeBounds(l,a,t);for(var m=0;m<2;++m){var _=this.m_bounds[m],h=0,c=0,u=[h],y=[c];this.Query(u,y,l[m],a[m],_,r,m),h=u[0],c=y[0];var p,x,d=new Array,f=0,b=r-c;for(f=0;f<b;f++)d[f]=new s,p=d[f],x=_[c+f],p.value=x.value,p.proxyId=x.proxyId,p.stabbingCount=x.stabbingCount;b=d.length;var v=c+2;for(f=0;f<b;f++)x=d[f],p=_[v+f],p.value=x.value,p.proxyId=x.proxyId,p.stabbingCount=x.stabbingCount;for(d=new Array,b=c-h,f=0;f<b;f++)d[f]=new s,p=d[f],x=_[h+f],p.value=x.value,p.proxyId=x.proxyId,p.stabbingCount=x.stabbingCount;for(b=d.length,v=h+1,f=0;f<b;f++)x=d[f],p=_[v+f],p.value=x.value,p.proxyId=x.proxyId,p.stabbingCount=x.stabbingCount;for(++c,_[h].value=l[m],_[h].proxyId=e,_[c].value=a[m],_[c].proxyId=e,_[h].stabbingCount=0==h?0:_[h-1].stabbingCount,_[c].stabbingCount=_[c-1].stabbingCount,n=h;n<c;++n)_[n].stabbingCount++;for(n=h;n<r+2;++n){var g=this.m_proxyPool[_[n].proxyId];_[n].IsLower()?g.lowerBounds[m]=n:g.upperBounds[m]=n}}++this.m_proxyCount;for(var A=0;A<this.m_queryResultCount;++A)this.m_pairManager.AddBufferedPair(e,this.m_queryResults[A]);return this.m_pairManager.Commit(),this.m_queryResultCount=0,this.IncrementTimeStamp(),e},DestroyProxy:function(t){for(var i=this.m_proxyPool[t],o=2*this.m_proxyCount,n=0;n<2;++n){var e,r,l=this.m_bounds[n],a=i.lowerBounds[n],m=i.upperBounds[n],_=l[a].value,h=l[m].value,u=new Array,y=0,p=m-a-1;for(y=0;y<p;y++)u[y]=new s,e=u[y],r=l[a+1+y],e.value=r.value,e.proxyId=r.proxyId,e.stabbingCount=r.stabbingCount;p=u.length;var x=a;for(y=0;y<p;y++)r=u[y],e=l[x+y],e.value=r.value,e.proxyId=r.proxyId,e.stabbingCount=r.stabbingCount;for(u=new Array,p=o-m-1,y=0;y<p;y++)u[y]=new s,e=u[y],r=l[m+1+y],e.value=r.value,e.proxyId=r.proxyId,e.stabbingCount=r.stabbingCount;for(p=u.length,x=m-1,y=0;y<p;y++)r=u[y],e=l[x+y],e.value=r.value,e.proxyId=r.proxyId,e.stabbingCount=r.stabbingCount;p=o-2;for(var d=a;d<p;++d){var f=this.m_proxyPool[l[d].proxyId];l[d].IsLower()?f.lowerBounds[n]=d:f.upperBounds[n]=d}p=m-1;for(var b=a;b<p;++b)l[b].stabbingCount--;this.Query([0],[0],_,h,l,o-2,n)}for(var v=0;v<this.m_queryResultCount;++v)this.m_pairManager.RemoveBufferedPair(t,this.m_queryResults[v]);this.m_pairManager.Commit(),this.m_queryResultCount=0,this.IncrementTimeStamp(),i.userData=null,i.overlapCount=c.b2_invalid,i.lowerBounds[0]=c.b2_invalid,i.lowerBounds[1]=c.b2_invalid,i.upperBounds[0]=c.b2_invalid,i.upperBounds[1]=c.b2_invalid,i.SetNext(this.m_freeProxy),this.m_freeProxy=t,--this.m_proxyCount},MoveProxy:function(i,o){var n,e,s,l,m=0,_=0,h=0;if(!(i==a.b2_nullProxy||t.b2_maxProxies<=i)&&0!=o.IsValid()){var c=2*this.m_proxyCount,u=this.m_proxyPool[i],y=new r;this.ComputeBounds(y.lowerValues,y.upperValues,o);var p=new r;for(m=0;m<2;++m)p.lowerValues[m]=this.m_bounds[m][u.lowerBounds[m]].value,p.upperValues[m]=this.m_bounds[m][u.upperBounds[m]].value;for(m=0;m<2;++m){var x=this.m_bounds[m],d=u.lowerBounds[m],f=u.upperBounds[m],b=y.lowerValues[m],v=y.upperValues[m],g=b-x[d].value,A=v-x[f].value;if(x[d].value=b,x[f].value=v,g<0){_=d;while(_>0&&b<x[_-1].value){n=x[_],e=x[_-1];var w=e.proxyId,S=this.m_proxyPool[e.proxyId];e.stabbingCount++,1==e.IsUpper()?(this.TestOverlap(y,S)&&this.m_pairManager.AddBufferedPair(i,w),S.upperBounds[m]++,n.stabbingCount++):(S.lowerBounds[m]++,n.stabbingCount--),u.lowerBounds[m]--,n.Swap(e),--_}}if(A>0){_=f;while(_<c-1&&x[_+1].value<=v)n=x[_],s=x[_+1],h=s.proxyId,l=this.m_proxyPool[h],s.stabbingCount++,1==s.IsLower()?(this.TestOverlap(y,l)&&this.m_pairManager.AddBufferedPair(i,h),l.lowerBounds[m]--,n.stabbingCount++):(l.upperBounds[m]--,n.stabbingCount--),u.upperBounds[m]++,n.Swap(s),_++}if(g>0){_=d;while(_<c-1&&x[_+1].value<=b)n=x[_],s=x[_+1],h=s.proxyId,l=this.m_proxyPool[h],s.stabbingCount--,s.IsUpper()?(this.TestOverlap(p,l)&&this.m_pairManager.RemoveBufferedPair(i,h),l.upperBounds[m]--,n.stabbingCount--):(l.lowerBounds[m]--,n.stabbingCount++),u.lowerBounds[m]++,n.Swap(s),_++}if(A<0){_=f;while(_>0&&v<x[_-1].value)n=x[_],e=x[_-1],w=e.proxyId,S=this.m_proxyPool[w],e.stabbingCount--,1==e.IsLower()?(this.TestOverlap(p,S)&&this.m_pairManager.RemoveBufferedPair(i,w),S.lowerBounds[m]++,n.stabbingCount--):(S.upperBounds[m]++,n.stabbingCount++),u.upperBounds[m]--,n.Swap(e),_--}}}},Commit:function(){this.m_pairManager.Commit()},QueryAABB:function(t,i,o){var n=new Array,e=new Array;this.ComputeBounds(n,e,t);var s=0,r=0,l=[s],a=[r];this.Query(l,a,n[0],e[0],this.m_bounds[0],2*this.m_proxyCount,0),this.Query(l,a,n[1],e[1],this.m_bounds[1],2*this.m_proxyCount,1);for(var m=0,_=0;_<this.m_queryResultCount&&m<o;++_,++m){var h=this.m_proxyPool[this.m_queryResults[_]];i[_]=h.userData}return this.m_queryResultCount=0,this.IncrementTimeStamp(),m},Validate:function(){for(var t=0;t<2;++t)for(var i=this.m_bounds[t],o=2*this.m_proxyCount,n=0;n<o;++n){var e=i[n];1==e.IsLower()?0:0}},ComputeBounds:function(i,o,e){var s=e.minVertex.x,r=e.minVertex.y;s=n.b2Min(s,this.m_worldAABB.maxVertex.x),r=n.b2Min(r,this.m_worldAABB.maxVertex.y),s=n.b2Max(s,this.m_worldAABB.minVertex.x),r=n.b2Max(r,this.m_worldAABB.minVertex.y);var l=e.maxVertex.x,a=e.maxVertex.y;l=n.b2Min(l,this.m_worldAABB.maxVertex.x),a=n.b2Min(a,this.m_worldAABB.maxVertex.y),l=n.b2Max(l,this.m_worldAABB.minVertex.x),a=n.b2Max(a,this.m_worldAABB.minVertex.y),i[0]=this.m_quantizationFactor.x*(s-this.m_worldAABB.minVertex.x)&t.USHRT_MAX-1,o[0]=this.m_quantizationFactor.x*(l-this.m_worldAABB.minVertex.x)&65535|1,i[1]=this.m_quantizationFactor.y*(r-this.m_worldAABB.minVertex.y)&t.USHRT_MAX-1,o[1]=this.m_quantizationFactor.y*(a-this.m_worldAABB.minVertex.y)&65535|1},TestOverlapValidate:function(t,i){for(var o=0;o<2;++o){var n=this.m_bounds[o];if(n[t.lowerBounds[o]].value>n[i.upperBounds[o]].value)return!1;if(n[t.upperBounds[o]].value<n[i.lowerBounds[o]].value)return!1}return!0},TestOverlap:function(t,i){for(var o=0;o<2;++o){var n=this.m_bounds[o];if(t.lowerValues[o]>n[i.upperBounds[o]].value)return!1;if(t.upperValues[o]<n[i.lowerBounds[o]].value)return!1}return!0},Query:function(t,i,o,n,e,s,r){for(var l=c.BinarySearch(e,s,o),a=c.BinarySearch(e,s,n),m=l;m<a;++m)e[m].IsLower()&&this.IncrementOverlapCount(e[m].proxyId);if(l>0){var _=l-1,h=e[_].stabbingCount;while(h){if(e[_].IsLower()){var u=this.m_proxyPool[e[_].proxyId];l<=u.upperBounds[r]&&(this.IncrementOverlapCount(e[_].proxyId),--h)}--_}}t[0]=l,i[0]=a},IncrementOverlapCount:function(t){var i=this.m_proxyPool[t];i.timeStamp<this.m_timeStamp?(i.timeStamp=this.m_timeStamp,i.overlapCount=1):(i.overlapCount=2,this.m_queryResults[this.m_queryResultCount]=t,++this.m_queryResultCount)},IncrementTimeStamp:function(){if(this.m_timeStamp==t.USHRT_MAX){for(var i=0;i<t.b2_maxProxies;++i)this.m_proxyPool[i].timeStamp=0;this.m_timeStamp=1}else++this.m_timeStamp},m_pairManager:new h,m_proxyPool:new Array(t.b2_maxPairs),m_freeProxy:0,m_bounds:new Array(2*t.b2_maxProxies),m_queryResults:new Array(t.b2_maxProxies),m_queryResultCount:0,m_worldAABB:null,m_quantizationFactor:new i,m_proxyCount:0,m_timeStamp:0},c.s_validate=!1,c.b2_invalid=t.USHRT_MAX,c.b2_nullEdge=t.USHRT_MAX,c.BinarySearch=function(t,i,o){var n=0,e=i-1;while(n<=e){var s=Math.floor((n+e)/2);if(t[s].value>o)e=s-1;else{if(!(t[s].value<o))return s;n=s+1}}return n};var u=l.create();u.prototype={initialize:function(){}},u.b2_nullFeature=255,u.ClipSegmentToLine=function(t,i,o,e){var s=0,r=i[0].v,l=i[1].v,a=n.b2Dot(o,i[0].v)-e,m=n.b2Dot(o,i[1].v)-e;if(a<=0&&(t[s++]=i[0]),m<=0&&(t[s++]=i[1]),a*m<0){var _=a/(a-m),h=t[s].v;h.x=r.x+_*(l.x-r.x),h.y=r.y+_*(l.y-r.y),t[s].id=a>0?i[0].id:i[1].id,++s}return s},u.EdgeSeparation=function(t,i,o){var n=t.m_vertices,e=o.m_vertexCount,s=o.m_vertices,r=t.m_normals[i].x,l=t.m_normals[i].y,a=r,m=t.m_R;r=m.col1.x*a+m.col2.x*l,l=m.col1.y*a+m.col2.y*l;var _=r,h=l;m=o.m_R,a=_*m.col1.x+h*m.col1.y,h=_*m.col2.x+h*m.col2.y,_=a;for(var c=0,u=Number.MAX_VALUE,y=0;y<e;++y){var p=s[y],x=p.x*_+p.y*h;x<u&&(u=x,c=y)}m=t.m_R;var d=t.m_position.x+(m.col1.x*n[i].x+m.col2.x*n[i].y),f=t.m_position.y+(m.col1.y*n[i].x+m.col2.y*n[i].y);m=o.m_R;var b=o.m_position.x+(m.col1.x*s[c].x+m.col2.x*s[c].y),v=o.m_position.y+(m.col1.y*s[c].x+m.col2.y*s[c].y);b-=d,v-=f;var g=b*r+v*l;return g},u.FindMaxSeparation=function(t,i,o,n){for(var e=i.m_vertexCount,s=o.m_position.x-i.m_position.x,r=o.m_position.y-i.m_position.y,l=s*i.m_R.col1.x+r*i.m_R.col1.y,a=s*i.m_R.col2.x+r*i.m_R.col2.y,m=0,_=-Number.MAX_VALUE,h=0;h<e;++h){var c=i.m_normals[h].x*l+i.m_normals[h].y*a;c>_&&(_=c,m=h)}var y=u.EdgeSeparation(i,m,o);if(y>0&&0==n)return y;var p=m-1>=0?m-1:e-1,x=u.EdgeSeparation(i,p,o);if(x>0&&0==n)return x;var d=m+1<e?m+1:0,f=u.EdgeSeparation(i,d,o);if(f>0&&0==n)return f;var b,v=0,g=0;if(x>y&&x>f)g=-1,v=p,b=x;else{if(!(f>y))return t[0]=m,y;g=1,v=d,b=f}while(1){if(m=-1==g?v-1>=0?v-1:e-1:v+1<e?v+1:0,y=u.EdgeSeparation(i,m,o),y>0&&0==n)return y;if(!(y>b))break;v=m,b=y}return t[0]=v,b},u.FindIncidentEdge=function(t,i,o,n){var e=i.m_vertexCount,s=i.m_vertices,r=n.m_vertexCount,l=n.m_vertices,a=o,m=o+1==e?0:o+1,_=s[m],h=_.x,c=_.y;_=s[a],h-=_.x,c-=_.y;var u=h;h=c,c=-u;var y=1/Math.sqrt(h*h+c*c);h*=y,c*=y;var p=h,x=c;u=p;var d=i.m_R;p=d.col1.x*u+d.col2.x*x,x=d.col1.y*u+d.col2.y*x;var f=p,b=x;d=n.m_R,u=f*d.col1.x+b*d.col1.y,b=f*d.col2.x+b*d.col2.y,f=u;for(var v,g=0,A=0,w=Number.MAX_VALUE,S=0;S<r;++S){var V=S,M=S+1<r?S+1:0;_=l[M];var I=_.x,C=_.y;_=l[V],I-=_.x,C-=_.y,u=I,I=C,C=-u,y=1/Math.sqrt(I*I+C*C),I*=y,C*=y;var P=I*f+C*b;P<w&&(w=P,g=V,A=M)}v=t[0],_=v.v,_.SetV(l[g]),_.MulM(n.m_R),_.Add(n.m_position),v.id.features.referenceFace=o,v.id.features.incidentEdge=g,v.id.features.incidentVertex=g,v=t[1],_=v.v,_.SetV(l[A]),_.MulM(n.m_R),_.Add(n.m_position),v.id.features.referenceFace=o,v.id.features.incidentEdge=g,v.id.features.incidentVertex=A},u.b2CollidePolyTempVec=new i,u.b2CollidePoly=function(i,o,n,e){i.pointCount=0;var s=0,r=[s],l=u.FindMaxSeparation(r,o,n,e);if(s=r[0],!(l>0&&0==e)){var a=0,m=[a],_=u.FindMaxSeparation(m,n,o,e);if(a=m[0],!(_>0&&0==e)){var h,c,y=0,p=0,x=.98,d=.001;_>x*l+d?(h=n,c=o,y=a,p=1):(h=o,c=n,y=s,p=0);var f=[new A,new A];u.FindIncidentEdge(f,h,y,c);var b=h.m_vertexCount,v=h.m_vertices,g=v[y],w=y+1<b?v[y+1]:v[0],S=(w.x,g.x,w.y,g.y,w.x-g.x),V=w.y-g.y,M=S,I=h.m_R;S=I.col1.x*M+I.col2.x*V,V=I.col1.y*M+I.col2.y*V;var C=1/Math.sqrt(S*S+V*V);S*=C,V*=C;var P=S,B=V;M=P,P=B,B=-M;var R=g.x,L=g.y;M=R,I=h.m_R,R=I.col1.x*M+I.col2.x*L,L=I.col1.y*M+I.col2.y*L,R+=h.m_position.x,L+=h.m_position.y;var F=w.x,J=w.y;M=F,I=h.m_R,F=I.col1.x*M+I.col2.x*J,J=I.col1.y*M+I.col2.y*J,F+=h.m_position.x,J+=h.m_position.y;var D=P*R+B*L,j=-(S*R+V*L),O=S*F+V*J,T=[new A,new A],k=[new A,new A],G=0;if(u.b2CollidePolyTempVec.Set(-S,-V),G=u.ClipSegmentToLine(T,f,u.b2CollidePolyTempVec,j),!(G<2)&&(u.b2CollidePolyTempVec.Set(S,V),G=u.ClipSegmentToLine(k,T,u.b2CollidePolyTempVec,O),!(G<2))){p?i.normal.Set(-P,-B):i.normal.Set(P,B);for(var z=0,E=0;E<t.b2_maxManifoldPoints;++E){var q=k[E].v,N=P*q.x+B*q.y-D;if(N<=0||1==e){var U=i.points[z];U.separation=N,U.position.SetV(k[E].v),U.id.Set(k[E].id),U.id.features.flip=p,++z}}i.pointCount=z}}}},u.b2CollideCircle=function(t,i,o,n){t.pointCount=0;var e=o.m_position.x-i.m_position.x,s=o.m_position.y-i.m_position.y,r=e*e+s*s,l=i.m_radius+o.m_radius;if(!(r>l*l&&0==n)){var a;if(r<Number.MIN_VALUE)a=-l,t.normal.Set(0,1);else{var m=Math.sqrt(r);a=m-l;var _=1/m;t.normal.x=_*e,t.normal.y=_*s}t.pointCount=1;var h=t.points[0];h.id.set_key(0),h.separation=a,h.position.x=o.m_position.x-o.m_radius*t.normal.x,h.position.y=o.m_position.y-o.m_radius*t.normal.y}},u.b2CollidePolyAndCircle=function(t,i,o,n){var e,s,r;t.pointCount=0;var l,a=o.m_position.x-i.m_position.x,m=o.m_position.y-i.m_position.y,_=i.m_R,h=a*_.col1.x+m*_.col1.y;m=a*_.col2.x+m*_.col2.y,a=h;for(var c=0,y=-Number.MAX_VALUE,p=o.m_radius,x=0;x<i.m_vertexCount;++x){var d=i.m_normals[x].x*(a-i.m_vertices[x].x)+i.m_normals[x].y*(m-i.m_vertices[x].y);if(d>p)return;d>y&&(y=d,c=x)}if(y<Number.MIN_VALUE){t.pointCount=1;var f=i.m_normals[c];return t.normal.x=_.col1.x*f.x+_.col2.x*f.y,t.normal.y=_.col1.y*f.x+_.col2.y*f.y,e=t.points[0],e.id.features.incidentEdge=c,e.id.features.incidentVertex=u.b2_nullFeature,e.id.features.referenceFace=u.b2_nullFeature,e.id.features.flip=0,e.position.x=o.m_position.x-p*t.normal.x,e.position.y=o.m_position.y-p*t.normal.y,void(e.separation=y-p)}var b=c,v=b+1<i.m_vertexCount?b+1:0,g=i.m_vertices[v].x-i.m_vertices[b].x,A=i.m_vertices[v].y-i.m_vertices[b].y,w=Math.sqrt(g*g+A*A);if(g/=w,A/=w,w<Number.MIN_VALUE){if(s=a-i.m_vertices[b].x,r=m-i.m_vertices[b].y,l=Math.sqrt(s*s+r*r),s/=l,r/=l,l>p)return;return t.pointCount=1,t.normal.Set(_.col1.x*s+_.col2.x*r,_.col1.y*s+_.col2.y*r),e=t.points[0],e.id.features.incidentEdge=u.b2_nullFeature,e.id.features.incidentVertex=b,e.id.features.referenceFace=u.b2_nullFeature,e.id.features.flip=0,e.position.x=o.m_position.x-p*t.normal.x,e.position.y=o.m_position.y-p*t.normal.y,void(e.separation=l-p)}var S,V,M=(a-i.m_vertices[b].x)*g+(m-i.m_vertices[b].y)*A;e=t.points[0],e.id.features.incidentEdge=u.b2_nullFeature,e.id.features.incidentVertex=u.b2_nullFeature,e.id.features.referenceFace=u.b2_nullFeature,e.id.features.flip=0,M<=0?(S=i.m_vertices[b].x,V=i.m_vertices[b].y,e.id.features.incidentVertex=b):M>=w?(S=i.m_vertices[v].x,V=i.m_vertices[v].y,e.id.features.incidentVertex=v):(S=g*M+i.m_vertices[b].x,V=A*M+i.m_vertices[b].y,e.id.features.incidentEdge=b),s=a-S,r=m-V,l=Math.sqrt(s*s+r*r),s/=l,r/=l,l>p||(t.pointCount=1,t.normal.Set(_.col1.x*s+_.col2.x*r,_.col1.y*s+_.col2.y*r),e.position.x=o.m_position.x-p*t.normal.x,e.position.y=o.m_position.y-p*t.normal.y,e.separation=l-p)},u.b2TestOverlap=function(t,i){var o=i.minVertex,n=t.maxVertex,e=o.x-n.x,s=o.y-n.y;o=t.minVertex,n=i.maxVertex;var r=o.x-n.x,l=o.y-n.y;return!(e>0||s>0)&&!(r>0||l>0)};var y=l.create();y.prototype={set_referenceFace:function(t){this._referenceFace=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceFace},get_referenceFace:function(){return this._referenceFace},_referenceFace:0,set_incidentEdge:function(t){this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280},get_incidentEdge:function(){return this._incidentEdge},_incidentEdge:0,set_incidentVertex:function(t){this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680},get_incidentVertex:function(){return this._incidentVertex},_incidentVertex:0,set_flip:function(t){this._flip=t,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080},get_flip:function(){return this._flip},_flip:0,_m_id:null,initialize:function(){}};var p=l.create();p.prototype={initialize:function(){this.features=new y,this.features._m_id=this},Set:function(t){this.set_key(t._key)},Copy:function(){var t=new p;return t.set_key(this._key),t},get_key:function(){return this._key},set_key:function(t){this._key=t,this.features._referenceFace=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255},features:new y,_key:0};var x=l.create();x.prototype={position:new i,separation:null,normalImpulse:null,tangentImpulse:null,id:new p,initialize:function(){this.position=new i,this.id=new p}};var f=l.create();f.prototype={initialize:function(){}},f.ProcessTwo=function(t,i,o,n,e){var s=-e[1].x,r=-e[1].y,l=e[0].x-e[1].x,a=e[0].y-e[1].y,m=Math.sqrt(l*l+a*a);l/=m,a/=m;var _=s*l+r*a;return _<=0||m<Number.MIN_VALUE?(t.SetV(o[1]),i.SetV(n[1]),o[0].SetV(o[1]),n[0].SetV(n[1]),e[0].SetV(e[1]),1):(_/=m,t.x=o[1].x+_*(o[0].x-o[1].x),t.y=o[1].y+_*(o[0].y-o[1].y),i.x=n[1].x+_*(n[0].x-n[1].x),i.y=n[1].y+_*(n[0].y-n[1].y),2)},f.ProcessThree=function(t,i,o,n,e){var s=e[0].x,r=e[0].y,l=e[1].x,a=e[1].y,m=e[2].x,_=e[2].y,h=l-s,c=a-r,u=m-s,y=_-r,p=m-l,x=_-a,d=-(s*u+r*y),f=m*u+_*y,b=-(l*p+a*x),v=m*p+_*x;if(f<=0&&v<=0)return t.SetV(o[2]),i.SetV(n[2]),o[0].SetV(o[2]),n[0].SetV(n[2]),e[0].SetV(e[2]),1;var g=h*y-c*u,A=g*(s*a-r*l),w=g*(l*_-a*m);if(w<=0&&b>=0&&v>=0){var S=b/(b+v);return t.x=o[1].x+S*(o[2].x-o[1].x),t.y=o[1].y+S*(o[2].y-o[1].y),i.x=n[1].x+S*(n[2].x-n[1].x),i.y=n[1].y+S*(n[2].y-n[1].y),o[0].SetV(o[2]),n[0].SetV(n[2]),e[0].SetV(e[2]),2}var V=g*(m*r-_*s);if(V<=0&&d>=0&&f>=0){S=d/(d+f);return t.x=o[0].x+S*(o[2].x-o[0].x),t.y=o[0].y+S*(o[2].y-o[0].y),i.x=n[0].x+S*(n[2].x-n[0].x),i.y=n[0].y+S*(n[2].y-n[0].y),o[1].SetV(o[2]),n[1].SetV(n[2]),e[1].SetV(e[2]),2}var M=w+V+A;M=1/M;var I=w*M,C=V*M,P=1-I-C;return t.x=I*o[0].x+C*o[1].x+P*o[2].x,t.y=I*o[0].y+C*o[1].y+P*o[2].y,i.x=I*n[0].x+C*n[1].x+P*n[2].x,i.y=I*n[0].y+C*n[1].y+P*n[2].y,3},f.InPoinsts=function(t,i,o){for(var n=0;n<o;++n)if(t.x==i[n].x&&t.y==i[n].y)return!0;return!1},f.Distance=function(t,i,o,e){var s=new Array(3),r=new Array(3),l=new Array(3),a=0;t.SetV(o.m_position),i.SetV(e.m_position);for(var m=0,_=20,h=0;h<_;++h){var c=i.x-t.x,u=i.y-t.y,y=o.Support(c,u),p=e.Support(-c,-u);m=c*c+u*u;var x=p.x-y.x,d=p.y-y.y;if(m-b2Dot(c*x+u*d)<=.01*m)return 0==a&&(t.SetV(y),i.SetV(p)),f.g_GJK_Iterations=h,Math.sqrt(m);switch(a){case 0:s[0].SetV(y),r[0].SetV(p),l[0]=w,t.SetV(s[0]),i.SetV(r[0]),++a;break;case 1:s[1].SetV(y),r[1].SetV(p),l[1].x=x,l[1].y=d,a=f.ProcessTwo(t,i,s,r,l);break;case 2:s[2].SetV(y),r[2].SetV(p),l[2].x=x,l[2].y=d,a=f.ProcessThree(t,i,s,r,l);break}if(3==a)return f.g_GJK_Iterations=h,0;for(var b=-Number.MAX_VALUE,v=0;v<a;++v)b=n.b2Max(b,l[v].x*l[v].x+l[v].y*l[v].y);if(3==a||m<=100*Number.MIN_VALUE*b)return f.g_GJK_Iterations=h,Math.sqrt(m)}return f.g_GJK_Iterations=_,Math.sqrt(m)},f.g_GJK_Iterations=0;var b=l.create();b.prototype={initialize:function(){this.points=new Array(t.b2_maxManifoldPoints);for(var o=0;o<t.b2_maxManifoldPoints;o++)this.points[o]=new x;this.normal=new i},points:null,normal:null,pointCount:0};var v=l.create();v.prototype={R:new o,center:new i,extents:new i,initialize:function(){this.R=new o,this.center=new i,this.extents=new i}};var g=l.create();g.prototype={GetNext:function(){return this.lowerBounds[0]},SetNext:function(t){this.lowerBounds[0]=t},IsValid:function(){return this.overlapCount!=c.b2_invalid},lowerBounds:[0,0],upperBounds:[0,0],overlapCount:0,timeStamp:0,userData:null,initialize:function(){this.lowerBounds=[0,0],this.upperBounds=[0,0]}};var A=l.create();A.prototype={v:new i,id:new p,initialize:function(){this.v=new i,this.id=new p}};var S=l.create();S.prototype={TestPoint:function(t){return!1},GetUserData:function(){return this.m_userData},GetType:function(){return this.m_type},GetBody:function(){return this.m_body},GetPosition:function(){return this.m_position},GetRotationMatrix:function(){return this.m_R},ResetProxy:function(t){},GetNext:function(){return this.m_next},initialize:function(t,n){this.m_R=new o,this.m_position=new i,this.m_userData=t.userData,this.m_friction=t.friction,this.m_restitution=t.restitution,this.m_body=n,this.m_proxyId=a.b2_nullProxy,this.m_maxRadius=0,this.m_categoryBits=t.categoryBits,this.m_maskBits=t.maskBits,this.m_groupIndex=t.groupIndex},DestroyProxy:function(){this.m_proxyId!=a.b2_nullProxy&&(this.m_body.m_world.m_broadPhase.DestroyProxy(this.m_proxyId),this.m_proxyId=a.b2_nullProxy)},Synchronize:function(t,i,o,n){},QuickSync:function(t,i){},Support:function(t,i,o){},GetMaxRadius:function(){return this.m_maxRadius},m_next:null,m_R:new o,m_position:new i,m_type:0,m_userData:null,m_body:null,m_friction:null,m_restitution:null,m_maxRadius:null,m_proxyId:0,m_categoryBits:0,m_maskBits:0,m_groupIndex:0},S.Create=function(t,i,o){switch(t.type){case S.e_circleShape:return new C(t,i,o);case S.e_boxShape:case S.e_polyShape:return new R(t,i,o)}return null},S.Destroy=function(t){t.m_proxyId!=a.b2_nullProxy&&t.m_body.m_world.m_broadPhase.DestroyProxy(t.m_proxyId)},S.e_unknownShape=-1,S.e_circleShape=0,S.e_boxShape=1,S.e_polyShape=2,S.e_meshShape=3,S.e_shapeTypeCount=4,S.PolyMass=function(t,o,e,s){var r=new i;r.SetZero();for(var l=0,a=0,m=new i(0,0),_=1/3,h=0;h<e;++h){var c=m,u=o[h],y=h+1<e?o[h+1]:o[0],p=n.SubtractVV(u,c),x=n.SubtractVV(y,c),d=n.b2CrossVV(p,x),f=.5*d;l+=f;var b=new i;b.SetV(c),b.Add(u),b.Add(y),b.Multiply(_*f),r.Add(b);var v=c.x,g=c.y,A=p.x,w=p.y,S=x.x,V=x.y,M=_*(.25*(A*A+S*A+S*S)+(v*A+v*S))+.5*v*v,I=_*(.25*(w*w+V*w+V*V)+(g*w+g*V))+.5*g*g;a+=d*(M+I)}t.mass=s*l,r.Multiply(1/l),t.center=r,a=s*(a-l*n.b2Dot(r,r)),t.I=a},S.PolyCentroid=function(t,i,o){for(var n=0,e=0,s=0,r=0,l=0,a=1/3,m=0;m<i;++m){var _=r,h=l,c=t[m].x,u=t[m].y,y=m+1<i?t[m+1].x:t[0].x,p=m+1<i?t[m+1].y:t[0].y,x=c-_,d=u-h,f=y-_,b=p-h,v=x*b-d*f,g=.5*v;s+=g,n+=g*a*(_+c+y),e+=g*a*(h+u+p)}n*=1/s,e*=1/s,o.Set(n,e)};var V=l.create();V.prototype={initialize:function(){this.type=S.e_unknownShape,this.userData=null,this.localPosition=new i(0,0),this.localRotation=0,this.friction=.2,this.restitution=0,this.density=0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},ComputeMass:function(o){switch(o.center=new i(0,0),0==this.density&&(o.mass=0,o.center.Set(0,0),o.I=0),this.type){case S.e_circleShape:var e=this;o.mass=this.density*t.b2_pi*e.radius*e.radius,o.center.Set(0,0),o.I=.5*o.mass*e.radius*e.radius;break;case S.e_boxShape:var s=this;o.mass=4*this.density*s.extents.x*s.extents.y,o.center.Set(0,0),o.I=o.mass/3*n.b2Dot(s.extents,s.extents);break;case S.e_polyShape:var r=this;S.PolyMass(o,r.vertices,r.vertexCount,this.density);break;default:o.mass=0,o.center.Set(0,0),o.I=0;break}},type:0,userData:null,localPosition:null,localRotation:null,friction:null,restitution:null,density:null,categoryBits:0,maskBits:0,groupIndex:0};var M=l.create();Object.extend(M.prototype,V.prototype),Object.extend(M.prototype,{initialize:function(){this.type=S.e_unknownShape,this.userData=null,this.localPosition=new i(0,0),this.localRotation=0,this.friction=.2,this.restitution=0,this.density=0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0,this.type=S.e_boxShape,this.extents=new i(1,1)},extents:null});var I=l.create();Object.extend(I.prototype,V.prototype),Object.extend(I.prototype,{initialize:function(){this.type=S.e_unknownShape,this.userData=null,this.localPosition=new i(0,0),this.localRotation=0,this.friction=.2,this.restitution=0,this.density=0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0,this.type=S.e_circleShape,this.radius=1},radius:null});var C=l.create();Object.extend(C.prototype,S.prototype),Object.extend(C.prototype,{TestPoint:function(t){var o=new i;return o.SetV(t),o.Subtract(this.m_position),n.b2Dot(o,o)<=this.m_radius*this.m_radius},initialize:function(t,n,s){this.m_R=new o,this.m_position=new i,this.m_userData=t.userData,this.m_friction=t.friction,this.m_restitution=t.restitution,this.m_body=n,this.m_proxyId=a.b2_nullProxy,this.m_maxRadius=0,this.m_categoryBits=t.categoryBits,this.m_maskBits=t.maskBits,this.m_groupIndex=t.groupIndex,this.m_localPosition=new i;var r=t;this.m_localPosition.Set(t.localPosition.x-s.x,t.localPosition.y-s.y),this.m_type=S.e_circleShape,this.m_radius=r.radius,this.m_R.SetM(this.m_body.m_R);var l=this.m_R.col1.x*this.m_localPosition.x+this.m_R.col2.x*this.m_localPosition.y,m=this.m_R.col1.y*this.m_localPosition.x+this.m_R.col2.y*this.m_localPosition.y;this.m_position.x=this.m_body.m_position.x+l,this.m_position.y=this.m_body.m_position.y+m,this.m_maxRadius=Math.sqrt(l*l+m*m)+this.m_radius;var _=new e;_.minVertex.Set(this.m_position.x-this.m_radius,this.m_position.y-this.m_radius),_.maxVertex.Set(this.m_position.x+this.m_radius,this.m_position.y+this.m_radius);var h=this.m_body.m_world.m_broadPhase;h.InRange(_)?this.m_proxyId=h.CreateProxy(_,this):this.m_proxyId=a.b2_nullProxy,this.m_proxyId==a.b2_nullProxy&&this.m_body.Freeze()},Synchronize:function(t,i,o,n){if(this.m_R.SetM(n),this.m_position.x=n.col1.x*this.m_localPosition.x+n.col2.x*this.m_localPosition.y+o.x,this.m_position.y=n.col1.y*this.m_localPosition.x+n.col2.y*this.m_localPosition.y+o.y,this.m_proxyId!=a.b2_nullProxy){var s=t.x+(i.col1.x*this.m_localPosition.x+i.col2.x*this.m_localPosition.y),r=t.y+(i.col1.y*this.m_localPosition.x+i.col2.y*this.m_localPosition.y),l=Math.min(s,this.m_position.x),m=Math.min(r,this.m_position.y),_=Math.max(s,this.m_position.x),h=Math.max(r,this.m_position.y),c=new e;c.minVertex.Set(l-this.m_radius,m-this.m_radius),c.maxVertex.Set(_+this.m_radius,h+this.m_radius);var u=this.m_body.m_world.m_broadPhase;u.InRange(c)?u.MoveProxy(this.m_proxyId,c):this.m_body.Freeze()}},QuickSync:function(t,i){this.m_R.SetM(i),this.m_position.x=i.col1.x*this.m_localPosition.x+i.col2.x*this.m_localPosition.y+t.x,this.m_position.y=i.col1.y*this.m_localPosition.x+i.col2.y*this.m_localPosition.y+t.y},ResetProxy:function(t){if(this.m_proxyId!=a.b2_nullProxy){t.GetProxy(this.m_proxyId);t.DestroyProxy(this.m_proxyId),null;var i=new e;i.minVertex.Set(this.m_position.x-this.m_radius,this.m_position.y-this.m_radius),i.maxVertex.Set(this.m_position.x+this.m_radius,this.m_position.y+this.m_radius),t.InRange(i)?this.m_proxyId=t.CreateProxy(i,this):this.m_proxyId=a.b2_nullProxy,this.m_proxyId==a.b2_nullProxy&&this.m_body.Freeze()}},Support:function(t,i,o){var n=Math.sqrt(t*t+i*i);t/=n,i/=n,o.Set(this.m_position.x+this.m_radius*t,this.m_position.y+this.m_radius*i)},m_localPosition:new i,m_radius:null});var P=l.create();P.prototype={mass:0,center:new i(0,0),I:0,initialize:function(){this.center=new i(0,0)}};var B=l.create();Object.extend(B.prototype,V.prototype),Object.extend(B.prototype,{initialize:function(){this.type=S.e_unknownShape,this.userData=null,this.localPosition=new i(0,0),this.localRotation=0,this.friction=.2,this.restitution=0,this.density=0,this.categoryBits=1,this.maskBits=65535,this.groupIndex=0,this.vertices=new Array(t.b2_maxPolyVertices),this.type=S.e_polyShape,this.vertexCount=0;for(var o=0;o<t.b2_maxPolyVertices;o++)this.vertices[o]=new i},vertices:new Array(t.b2_maxPolyVertices),vertexCount:0});var R=l.create();Object.extend(R.prototype,S.prototype),Object.extend(R.prototype,{TestPoint:function(t){var o=new i;o.SetV(t),o.Subtract(this.m_position),o.MulTM(this.m_R);for(var e=0;e<this.m_vertexCount;++e){var s=new i;s.SetV(o),s.Subtract(this.m_vertices[e]);var r=n.b2Dot(this.m_normals[e],s);if(r>0)return!1}return!0},initialize:function(n,s,r){this.m_R=new o,this.m_position=new i,this.m_userData=n.userData,this.m_friction=n.friction,this.m_restitution=n.restitution,this.m_body=s,this.m_proxyId=a.b2_nullProxy,this.m_maxRadius=0,this.m_categoryBits=n.categoryBits,this.m_maskBits=n.maskBits,this.m_groupIndex=n.groupIndex,this.syncAABB=new e,this.syncMat=new o,this.m_localCentroid=new i,this.m_localOBB=new v;var l,m,_,h=0,c=new e;this.m_vertices=new Array(t.b2_maxPolyVertices),this.m_coreVertices=new Array(t.b2_maxPolyVertices),this.m_normals=new Array(t.b2_maxPolyVertices),this.m_type=S.e_polyShape;var u=new o(n.localRotation);if(n.type==S.e_boxShape){this.m_localCentroid.x=n.localPosition.x-r.x,this.m_localCentroid.y=n.localPosition.y-r.y;var y=n;this.m_vertexCount=4,l=y.extents.x,m=y.extents.y;var p=Math.max(0,l-2*t.b2_linearSlop),x=Math.max(0,m-2*t.b2_linearSlop);_=this.m_vertices[0]=new i,_.x=u.col1.x*l+u.col2.x*m,_.y=u.col1.y*l+u.col2.y*m,_=this.m_vertices[1]=new i,_.x=u.col1.x*-l+u.col2.x*m,_.y=u.col1.y*-l+u.col2.y*m,_=this.m_vertices[2]=new i,_.x=u.col1.x*-l+u.col2.x*-m,_.y=u.col1.y*-l+u.col2.y*-m,_=this.m_vertices[3]=new i,_.x=u.col1.x*l+u.col2.x*-m,_.y=u.col1.y*l+u.col2.y*-m,_=this.m_coreVertices[0]=new i,_.x=u.col1.x*p+u.col2.x*x,_.y=u.col1.y*p+u.col2.y*x,_=this.m_coreVertices[1]=new i,_.x=u.col1.x*-p+u.col2.x*x,_.y=u.col1.y*-p+u.col2.y*x,_=this.m_coreVertices[2]=new i,_.x=u.col1.x*-p+u.col2.x*-x,_.y=u.col1.y*-p+u.col2.y*-x,_=this.m_coreVertices[3]=new i,_.x=u.col1.x*p+u.col2.x*-x,_.y=u.col1.y*p+u.col2.y*-x}else{var d=n;this.m_vertexCount=d.vertexCount,S.PolyCentroid(d.vertices,d.vertexCount,R.tempVec);var f=R.tempVec.x,b=R.tempVec.y;for(this.m_localCentroid.x=n.localPosition.x+(u.col1.x*f+u.col2.x*b)-r.x,this.m_localCentroid.y=n.localPosition.y+(u.col1.y*f+u.col2.y*b)-r.y,h=0;h<this.m_vertexCount;++h){this.m_vertices[h]=new i,this.m_coreVertices[h]=new i,l=d.vertices[h].x-f,m=d.vertices[h].y-b,this.m_vertices[h].x=u.col1.x*l+u.col2.x*m,this.m_vertices[h].y=u.col1.y*l+u.col2.y*m;var g=this.m_vertices[h].x,A=this.m_vertices[h].y,w=Math.sqrt(g*g+A*A);w>Number.MIN_VALUE&&(g*=1/w,A*=1/w),this.m_coreVertices[h].x=this.m_vertices[h].x-2*t.b2_linearSlop*g,this.m_coreVertices[h].y=this.m_vertices[h].y-2*t.b2_linearSlop*A}}var V=Number.MAX_VALUE,M=Number.MAX_VALUE,I=-Number.MAX_VALUE,C=-Number.MAX_VALUE;for(this.m_maxRadius=0,h=0;h<this.m_vertexCount;++h){var P=this.m_vertices[h];V=Math.min(V,P.x),M=Math.min(M,P.y),I=Math.max(I,P.x),C=Math.max(C,P.y),this.m_maxRadius=Math.max(this.m_maxRadius,P.Length())}this.m_localOBB.R.SetIdentity(),this.m_localOBB.center.Set(.5*(V+I),.5*(M+C)),this.m_localOBB.extents.Set(.5*(I-V),.5*(C-M));var B=0,L=0;for(h=0;h<this.m_vertexCount;++h)this.m_normals[h]=new i,B=h,L=h+1<this.m_vertexCount?h+1:0,this.m_normals[h].x=this.m_vertices[L].y-this.m_vertices[B].y,this.m_normals[h].y=-(this.m_vertices[L].x-this.m_vertices[B].x),this.m_normals[h].Normalize();for(h=0;h<this.m_vertexCount;++h)B=h,L=h+1<this.m_vertexCount?h+1:0;this.m_R.SetM(this.m_body.m_R),this.m_position.x=this.m_body.m_position.x+(this.m_R.col1.x*this.m_localCentroid.x+this.m_R.col2.x*this.m_localCentroid.y),this.m_position.y=this.m_body.m_position.y+(this.m_R.col1.y*this.m_localCentroid.x+this.m_R.col2.y*this.m_localCentroid.y),R.tAbsR.col1.x=this.m_R.col1.x*this.m_localOBB.R.col1.x+this.m_R.col2.x*this.m_localOBB.R.col1.y,R.tAbsR.col1.y=this.m_R.col1.y*this.m_localOBB.R.col1.x+this.m_R.col2.y*this.m_localOBB.R.col1.y,R.tAbsR.col2.x=this.m_R.col1.x*this.m_localOBB.R.col2.x+this.m_R.col2.x*this.m_localOBB.R.col2.y,R.tAbsR.col2.y=this.m_R.col1.y*this.m_localOBB.R.col2.x+this.m_R.col2.y*this.m_localOBB.R.col2.y,R.tAbsR.Abs(),l=R.tAbsR.col1.x*this.m_localOBB.extents.x+R.tAbsR.col2.x*this.m_localOBB.extents.y,m=R.tAbsR.col1.y*this.m_localOBB.extents.x+R.tAbsR.col2.y*this.m_localOBB.extents.y;var F=this.m_position.x+(this.m_R.col1.x*this.m_localOBB.center.x+this.m_R.col2.x*this.m_localOBB.center.y),J=this.m_position.y+(this.m_R.col1.y*this.m_localOBB.center.x+this.m_R.col2.y*this.m_localOBB.center.y);c.minVertex.x=F-l,c.minVertex.y=J-m,c.maxVertex.x=F+l,c.maxVertex.y=J+m;var D=this.m_body.m_world.m_broadPhase;D.InRange(c)?this.m_proxyId=D.CreateProxy(c,this):this.m_proxyId=a.b2_nullProxy,this.m_proxyId==a.b2_nullProxy&&this.m_body.Freeze()},syncAABB:new e,syncMat:new o,Synchronize:function(t,i,o,n){if(this.m_R.SetM(n),this.m_position.x=this.m_body.m_position.x+(n.col1.x*this.m_localCentroid.x+n.col2.x*this.m_localCentroid.y),this.m_position.y=this.m_body.m_position.y+(n.col1.y*this.m_localCentroid.x+n.col2.y*this.m_localCentroid.y),this.m_proxyId!=a.b2_nullProxy){var e,s,r=i.col1,l=i.col2,m=this.m_localOBB.R.col1,_=this.m_localOBB.R.col2;this.syncMat.col1.x=r.x*m.x+l.x*m.y,this.syncMat.col1.y=r.y*m.x+l.y*m.y,this.syncMat.col2.x=r.x*_.x+l.x*_.y,this.syncMat.col2.y=r.y*_.x+l.y*_.y,this.syncMat.Abs(),e=this.m_localCentroid.x+this.m_localOBB.center.x,s=this.m_localCentroid.y+this.m_localOBB.center.y;var h=t.x+(i.col1.x*e+i.col2.x*s),c=t.y+(i.col1.y*e+i.col2.y*s);e=this.syncMat.col1.x*this.m_localOBB.extents.x+this.syncMat.col2.x*this.m_localOBB.extents.y,s=this.syncMat.col1.y*this.m_localOBB.extents.x+this.syncMat.col2.y*this.m_localOBB.extents.y,this.syncAABB.minVertex.x=h-e,this.syncAABB.minVertex.y=c-s,this.syncAABB.maxVertex.x=h+e,this.syncAABB.maxVertex.y=c+s,r=n.col1,l=n.col2,m=this.m_localOBB.R.col1,_=this.m_localOBB.R.col2,this.syncMat.col1.x=r.x*m.x+l.x*m.y,this.syncMat.col1.y=r.y*m.x+l.y*m.y,this.syncMat.col2.x=r.x*_.x+l.x*_.y,this.syncMat.col2.y=r.y*_.x+l.y*_.y,this.syncMat.Abs(),e=this.m_localCentroid.x+this.m_localOBB.center.x,s=this.m_localCentroid.y+this.m_localOBB.center.y,h=o.x+(n.col1.x*e+n.col2.x*s),c=o.y+(n.col1.y*e+n.col2.y*s),e=this.syncMat.col1.x*this.m_localOBB.extents.x+this.syncMat.col2.x*this.m_localOBB.extents.y,s=this.syncMat.col1.y*this.m_localOBB.extents.x+this.syncMat.col2.y*this.m_localOBB.extents.y,this.syncAABB.minVertex.x=Math.min(this.syncAABB.minVertex.x,h-e),this.syncAABB.minVertex.y=Math.min(this.syncAABB.minVertex.y,c-s),this.syncAABB.maxVertex.x=Math.max(this.syncAABB.maxVertex.x,h+e),this.syncAABB.maxVertex.y=Math.max(this.syncAABB.maxVertex.y,c+s);var u=this.m_body.m_world.m_broadPhase;u.InRange(this.syncAABB)?u.MoveProxy(this.m_proxyId,this.syncAABB):this.m_body.Freeze()}},QuickSync:function(t,i){this.m_R.SetM(i),this.m_position.x=t.x+(i.col1.x*this.m_localCentroid.x+i.col2.x*this.m_localCentroid.y),this.m_position.y=t.y+(i.col1.y*this.m_localCentroid.x+i.col2.y*this.m_localCentroid.y)},ResetProxy:function(t){if(this.m_proxyId!=a.b2_nullProxy){t.GetProxy(this.m_proxyId);t.DestroyProxy(this.m_proxyId),null;var i=n.b2MulMM(this.m_R,this.m_localOBB.R),o=n.b2AbsM(i),s=n.b2MulMV(o,this.m_localOBB.extents),r=n.b2MulMV(this.m_R,this.m_localOBB.center);r.Add(this.m_position);var l=new e;l.minVertex.SetV(r),l.minVertex.Subtract(s),l.maxVertex.SetV(r),l.maxVertex.Add(s),t.InRange(l)?this.m_proxyId=t.CreateProxy(l,this):this.m_proxyId=a.b2_nullProxy,this.m_proxyId==a.b2_nullProxy&&this.m_body.Freeze()}},Support:function(t,i,o){for(var n=t*this.m_R.col1.x+i*this.m_R.col1.y,e=t*this.m_R.col2.x+i*this.m_R.col2.y,s=0,r=this.m_coreVertices[0].x*n+this.m_coreVertices[0].y*e,l=1;l<this.m_vertexCount;++l){var a=this.m_coreVertices[l].x*n+this.m_coreVertices[l].y*e;a>r&&(s=l,r=a)}o.Set(this.m_position.x+(this.m_R.col1.x*this.m_coreVertices[s].x+this.m_R.col2.x*this.m_coreVertices[s].y),this.m_position.y+(this.m_R.col1.y*this.m_coreVertices[s].x+this.m_R.col2.y*this.m_coreVertices[s].y))},m_localCentroid:new i,m_localOBB:new v,m_vertices:null,m_coreVertices:null,m_vertexCount:0,m_normals:null}),R.tempVec=new i,R.tAbsR=new o;var L=l.create();L.prototype={SetOriginPosition:function(t,i){if(!this.IsFrozen()){this.m_rotation=i,this.m_R.Set(this.m_rotation),this.m_position=n.AddVV(t,n.b2MulMV(this.m_R,this.m_center)),this.m_position0.SetV(this.m_position),this.m_rotation0=this.m_rotation;for(var o=this.m_shapeList;null!=o;o=o.m_next)o.Synchronize(this.m_position,this.m_R,this.m_position,this.m_R);this.m_world.m_broadPhase.Commit()}},GetOriginPosition:function(){return n.SubtractVV(this.m_position,n.b2MulMV(this.m_R,this.m_center))},SetCenterPosition:function(t,i){if(!this.IsFrozen()){this.m_rotation=i,this.m_R.Set(this.m_rotation),this.m_position.SetV(t),this.m_position0.SetV(this.m_position),this.m_rotation0=this.m_rotation;for(var o=this.m_shapeList;null!=o;o=o.m_next)o.Synchronize(this.m_position,this.m_R,this.m_position,this.m_R);this.m_world.m_broadPhase.Commit()}},GetCenterPosition:function(){return this.m_position},GetRotation:function(){return this.m_rotation},GetRotationMatrix:function(){return this.m_R},SetLinearVelocity:function(t){this.m_linearVelocity.SetV(t)},GetLinearVelocity:function(){return this.m_linearVelocity},SetAngularVelocity:function(t){this.m_angularVelocity=t},GetAngularVelocity:function(){return this.m_angularVelocity},ApplyForce:function(t,i){0==this.IsSleeping()&&(this.m_force.Add(t),this.m_torque+=n.b2CrossVV(n.SubtractVV(i,this.m_position),t))},ApplyTorque:function(t){0==this.IsSleeping()&&(this.m_torque+=t)},ApplyImpulse:function(t,i){0==this.IsSleeping()&&(this.m_linearVelocity.Add(n.MulFV(this.m_invMass,t)),this.m_angularVelocity+=this.m_invI*n.b2CrossVV(n.SubtractVV(i,this.m_position),t))},GetMass:function(){return this.m_mass},GetInertia:function(){return this.m_I},GetWorldPoint:function(t){return n.AddVV(this.m_position,n.b2MulMV(this.m_R,t))},GetWorldVector:function(t){return n.b2MulMV(this.m_R,t)},GetLocalPoint:function(t){return n.b2MulTMV(this.m_R,n.SubtractVV(t,this.m_position))},GetLocalVector:function(t){return n.b2MulTMV(this.m_R,t)},IsStatic:function(){return(this.m_flags&L.e_staticFlag)==L.e_staticFlag},IsFrozen:function(){return(this.m_flags&L.e_frozenFlag)==L.e_frozenFlag},IsSleeping:function(){return(this.m_flags&L.e_sleepFlag)==L.e_sleepFlag},AllowSleeping:function(t){t?this.m_flags|=L.e_allowSleepFlag:(this.m_flags&=~L.e_allowSleepFlag,this.WakeUp())},WakeUp:function(){this.m_flags&=~L.e_sleepFlag,this.m_sleepTime=0},GetShapeList:function(){return this.m_shapeList},GetContactList:function(){return this.m_contactList},GetJointList:function(){return this.m_jointList},GetNext:function(){return this.m_next},GetUserData:function(){return this.m_userData},initialize:function(e,s){this.sMat0=new o,this.m_position=new i,this.m_R=new o(0),this.m_position0=new i;var r,l,a=0;this.m_flags=0,this.m_position.SetV(e.position),this.m_rotation=e.rotation,this.m_R.Set(this.m_rotation),this.m_position0.SetV(this.m_position),this.m_rotation0=this.m_rotation,this.m_world=s,this.m_linearDamping=n.b2Clamp(1-e.linearDamping,0,1),this.m_angularDamping=n.b2Clamp(1-e.angularDamping,0,1),this.m_force=new i(0,0),this.m_torque=0,this.m_mass=0;var m=new Array(t.b2_maxShapesPerBody);for(a=0;a<t.b2_maxShapesPerBody;a++)m[a]=new P;for(this.m_shapeCount=0,this.m_center=new i(0,0),a=0;a<t.b2_maxShapesPerBody;++a){if(r=e.shapes[a],null==r)break;l=m[a],r.ComputeMass(l),this.m_mass+=l.mass,this.m_center.x+=l.mass*(r.localPosition.x+l.center.x),this.m_center.y+=l.mass*(r.localPosition.y+l.center.y),++this.m_shapeCount}for(this.m_mass>0?(this.m_center.Multiply(1/this.m_mass),this.m_position.Add(n.b2MulMV(this.m_R,this.m_center))):this.m_flags|=L.e_staticFlag,this.m_I=0,a=0;a<this.m_shapeCount;++a){r=e.shapes[a],l=m[a],this.m_I+=l.I;var _=n.SubtractVV(n.AddVV(r.localPosition,l.center),this.m_center);this.m_I+=l.mass*n.b2Dot(_,_)}for(this.m_mass>0?this.m_invMass=1/this.m_mass:this.m_invMass=0,this.m_I>0&&0==e.preventRotation?this.m_invI=1/this.m_I:(this.m_I=0,this.m_invI=0),this.m_linearVelocity=n.AddVV(e.linearVelocity,n.b2CrossFV(e.angularVelocity,this.m_center)),this.m_angularVelocity=e.angularVelocity,this.m_jointList=null,this.m_contactList=null,this.m_prev=null,this.m_next=null,this.m_shapeList=null,a=0;a<this.m_shapeCount;++a){r=e.shapes[a];var h=S.Create(r,this,this.m_center);h.m_next=this.m_shapeList,this.m_shapeList=h}this.m_sleepTime=0,e.allowSleep&&(this.m_flags|=L.e_allowSleepFlag),e.isSleeping&&(this.m_flags|=L.e_sleepFlag),(this.m_flags&L.e_sleepFlag||0==this.m_invMass)&&(this.m_linearVelocity.Set(0,0),this.m_angularVelocity=0),this.m_userData=e.userData},Destroy:function(){var t=this.m_shapeList;while(t){var i=t;t=t.m_next,S.Destroy(i)}},sMat0:new o,SynchronizeShapes:function(){this.sMat0.Set(this.m_rotation0);for(var t=this.m_shapeList;null!=t;t=t.m_next)t.Synchronize(this.m_position0,this.sMat0,this.m_position,this.m_R)},QuickSyncShapes:function(){for(var t=this.m_shapeList;null!=t;t=t.m_next)t.QuickSync(this.m_position,this.m_R)},IsConnected:function(t){for(var i=this.m_jointList;null!=i;i=i.next)if(i.other==t)return 0==i.joint.m_collideConnected;return!1},Freeze:function(){this.m_flags|=L.e_frozenFlag,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0;for(var t=this.m_shapeList;null!=t;t=t.m_next)t.DestroyProxy()},m_flags:0,m_position:new i,m_rotation:null,m_R:new o(0),m_position0:new i,m_rotation0:null,m_linearVelocity:null,m_angularVelocity:null,m_force:null,m_torque:null,m_center:null,m_world:null,m_prev:null,m_next:null,m_shapeList:null,m_shapeCount:0,m_jointList:null,m_contactList:null,m_mass:null,m_invMass:null,m_I:null,m_invI:null,m_linearDamping:null,m_angularDamping:null,m_sleepTime:null,m_userData:null},L.e_staticFlag=1,L.e_frozenFlag=2,L.e_islandFlag=4,L.e_sleepFlag=8,L.e_allowSleepFlag=16,L.e_destroyFlag=32;var F=l.create();F.prototype={initialize:function(){this.shapes=new Array,this.userData=null;for(var o=0;o<t.b2_maxShapesPerBody;o++)this.shapes[o]=null;this.position=new i(0,0),this.rotation=0,this.linearVelocity=new i(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.isSleeping=!1,this.preventRotation=!1},userData:null,shapes:new Array,position:null,rotation:null,linearVelocity:null,angularVelocity:null,linearDamping:null,angularDamping:null,allowSleep:null,isSleeping:null,preventRotation:null,AddShape:function(i){for(var o=0;o<t.b2_maxShapesPerBody;++o)if(null==this.shapes[o]){this.shapes[o]=i;break}}};var J=l.create();J.prototype={ShouldCollide:function(t,i){if(t.m_groupIndex==i.m_groupIndex&&0!=t.m_groupIndex)return t.m_groupIndex>0;var o=0!=(t.m_maskBits&i.m_categoryBits)&&0!=(t.m_categoryBits&i.m_maskBits);return o},initialize:function(){}},J.b2_defaultFilter=new J;var D=l.create();D.prototype={initialize:function(t,i,o,n){var e=0;for(this.m_bodyCapacity=t,this.m_contactCapacity=i,this.m_jointCapacity=o,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_bodies=new Array(t),e=0;e<t;e++)this.m_bodies[e]=null;for(this.m_contacts=new Array(i),e=0;e<i;e++)this.m_contacts[e]=null;for(this.m_joints=new Array(o),e=0;e<o;e++)this.m_joints[e]=null;this.m_allocator=n},Clear:function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},Solve:function(i,o){var e,s=0;for(s=0;s<this.m_bodyCount;++s)e=this.m_bodies[s],0!=e.m_invMass&&(e.m_linearVelocity.Add(n.MulFV(i.dt,n.AddVV(o,n.MulFV(e.m_invMass,e.m_force)))),e.m_angularVelocity+=i.dt*e.m_invI*e.m_torque,e.m_linearVelocity.Multiply(e.m_linearDamping),e.m_angularVelocity*=e.m_angularDamping,e.m_position0.SetV(e.m_position),e.m_rotation0=e.m_rotation);var r=new E(this.m_contacts,this.m_contactCount,this.m_allocator);for(r.PreSolve(),s=0;s<this.m_jointCount;++s)this.m_joints[s].PrepareVelocitySolver();for(s=0;s<i.iterations;++s){r.SolveVelocityConstraints();for(var l=0;l<this.m_jointCount;++l)this.m_joints[l].SolveVelocityConstraints(i)}for(s=0;s<this.m_bodyCount;++s)e=this.m_bodies[s],0!=e.m_invMass&&(e.m_position.x+=i.dt*e.m_linearVelocity.x,e.m_position.y+=i.dt*e.m_linearVelocity.y,e.m_rotation+=i.dt*e.m_angularVelocity,e.m_R.Set(e.m_rotation));for(s=0;s<this.m_jointCount;++s)this.m_joints[s].PreparePositionSolver();if(W.s_enablePositionCorrection)for(D.m_positionIterationCount=0;D.m_positionIterationCount<i.iterations;++D.m_positionIterationCount){var a=r.SolvePositionConstraints(t.b2_contactBaumgarte),m=!0;for(s=0;s<this.m_jointCount;++s){var _=this.m_joints[s].SolvePositionConstraints();m=m&&_}if(a&&m)break}for(r.PostSolve(),s=0;s<this.m_bodyCount;++s)e=this.m_bodies[s],0!=e.m_invMass&&(e.m_R.Set(e.m_rotation),e.SynchronizeShapes(),e.m_force.Set(0,0),e.m_torque=0)},UpdateSleep:function(i){var o,e=0,s=Number.MAX_VALUE,r=t.b2_linearSleepTolerance*t.b2_linearSleepTolerance,l=t.b2_angularSleepTolerance*t.b2_angularSleepTolerance;for(e=0;e<this.m_bodyCount;++e)o=this.m_bodies[e],0!=o.m_invMass&&(0==(o.m_flags&L.e_allowSleepFlag)&&(o.m_sleepTime=0,s=0),0==(o.m_flags&L.e_allowSleepFlag)||o.m_angularVelocity*o.m_angularVelocity>l||n.b2Dot(o.m_linearVelocity,o.m_linearVelocity)>r?(o.m_sleepTime=0,s=0):(o.m_sleepTime+=i,s=n.b2Min(s,o.m_sleepTime)));if(s>=t.b2_timeToSleep)for(e=0;e<this.m_bodyCount;++e)o=this.m_bodies[e],o.m_flags|=L.e_sleepFlag},AddBody:function(t){this.m_bodies[this.m_bodyCount++]=t},AddContact:function(t){this.m_contacts[this.m_contactCount++]=t},AddJoint:function(t){this.m_joints[this.m_jointCount++]=t},m_allocator:null,m_bodies:null,m_contacts:null,m_joints:null,m_bodyCount:0,m_jointCount:0,m_contactCount:0,m_bodyCapacity:0,m_contactCapacity:0,m_jointCapacity:0,m_positionError:null},D.m_positionIterationCount=0;var j=l.create();j.prototype={dt:null,inv_dt:null,iterations:0,initialize:function(){}};var O=l.create();O.prototype={other:null,contact:null,prev:null,next:null,initialize:function(){}};var T=l.create();T.prototype={GetManifolds:function(){return null},GetManifoldCount:function(){return this.m_manifoldCount},GetNext:function(){return this.m_next},GetShape1:function(){return this.m_shape1},GetShape2:function(){return this.m_shape2},initialize:function(t,i){if(this.m_node1=new O,this.m_node2=new O,this.m_flags=0,!t||!i)return this.m_shape1=null,void(this.m_shape2=null);this.m_shape1=t,this.m_shape2=i,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=n.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null},Evaluate:function(){},m_flags:0,m_prev:null,m_next:null,m_node1:new O,m_node2:new O,m_shape1:null,m_shape2:null,m_manifoldCount:0,m_friction:null,m_restitution:null},T.e_islandFlag=1,T.e_destroyFlag=2,T.AddType=function(t,i,o,n){T.s_registers[o][n].createFcn=t,T.s_registers[o][n].destroyFcn=i,T.s_registers[o][n].primary=!0,o!=n&&(T.s_registers[n][o].createFcn=t,T.s_registers[n][o].destroyFcn=i,T.s_registers[n][o].primary=!1)},T.InitializeRegisters=function(){T.s_registers=new Array(S.e_shapeTypeCount);for(var t=0;t<S.e_shapeTypeCount;t++){T.s_registers[t]=new Array(S.e_shapeTypeCount);for(var i=0;i<S.e_shapeTypeCount;i++)T.s_registers[t][i]=new z}T.AddType(q.Create,q.Destroy,S.e_circleShape,S.e_circleShape),T.AddType(K.Create,K.Destroy,S.e_polyShape,S.e_circleShape),T.AddType(X.Create,X.Destroy,S.e_polyShape,S.e_polyShape)},T.Create=function(t,i,o){0==T.s_initialized&&(T.InitializeRegisters(),T.s_initialized=!0);var n=t.m_type,e=i.m_type,s=T.s_registers[n][e].createFcn;if(s){if(T.s_registers[n][e].primary)return s(t,i,o);for(var r=s(i,t,o),l=0;l<r.GetManifoldCount();++l){var a=r.GetManifolds()[l];a.normal=a.normal.Negative()}return r}return null},T.Destroy=function(t,i){t.GetManifoldCount()>0&&(t.m_shape1.m_body.WakeUp(),t.m_shape2.m_body.WakeUp());var o=t.m_shape1.m_type,n=t.m_shape2.m_type,e=T.s_registers[o][n].destroyFcn;e(t,i)},T.s_registers=null,T.s_initialized=!1;var k=l.create();k.prototype={initialize:function(){this.normal=new i,this.points=new Array(t.b2_maxManifoldPoints);for(var o=0;o<t.b2_maxManifoldPoints;o++)this.points[o]=new G},points:null,normal:new i,manifold:null,body1:null,body2:null,friction:null,restitution:null,pointCount:0};var G=l.create();G.prototype={localAnchor1:new i,localAnchor2:new i,normalImpulse:null,tangentImpulse:null,positionImpulse:null,normalMass:null,tangentMass:null,separation:null,velocityBias:null,initialize:function(){this.localAnchor1=new i,this.localAnchor2=new i}};var z=l.create();z.prototype={createFcn:null,destroyFcn:null,primary:null,initialize:function(){}};var E=l.create();E.prototype={initialize:function(i,o,n){this.m_constraints=new Array,this.m_allocator=n;var e,s,r=0;for(this.m_constraintCount=0,r=0;r<o;++r)this.m_constraintCount+=i[r].GetManifoldCount();for(r=0;r<this.m_constraintCount;r++)this.m_constraints[r]=new k;var l=0;for(r=0;r<o;++r)for(var a=i[r],m=a.m_shape1.m_body,_=a.m_shape2.m_body,h=a.GetManifoldCount(),c=a.GetManifolds(),u=a.m_friction,y=a.m_restitution,p=m.m_linearVelocity.x,x=m.m_linearVelocity.y,d=_.m_linearVelocity.x,f=_.m_linearVelocity.y,b=m.m_angularVelocity,v=_.m_angularVelocity,g=0;g<h;++g){var A=c[g],w=A.normal.x,S=A.normal.y,V=this.m_constraints[l];V.body1=m,V.body2=_,V.manifold=A,V.normal.x=w,V.normal.y=S,V.pointCount=A.pointCount,V.friction=u,V.restitution=y;for(var M=0;M<V.pointCount;++M){var I=A.points[M],C=V.points[M];C.normalImpulse=I.normalImpulse,C.tangentImpulse=I.tangentImpulse,C.separation=I.separation;var P=I.position.x-m.m_position.x,B=I.position.y-m.m_position.y,R=I.position.x-_.m_position.x,L=I.position.y-_.m_position.y;e=C.localAnchor1,s=m.m_R,e.x=P*s.col1.x+B*s.col1.y,e.y=P*s.col2.x+B*s.col2.y,e=C.localAnchor2,s=_.m_R,e.x=R*s.col1.x+L*s.col1.y,e.y=R*s.col2.x+L*s.col2.y;var F=P*P+B*B,J=R*R+L*L,D=P*w+B*S,j=R*w+L*S,O=m.m_invMass+_.m_invMass;O+=m.m_invI*(F-D*D)+_.m_invI*(J-j*j),C.normalMass=1/O;var T=S,G=-w,z=P*T+B*G,E=R*T+L*G,q=m.m_invMass+_.m_invMass;q+=m.m_invI*(F-z*z)+_.m_invI*(J-E*E),C.tangentMass=1/q,C.velocityBias=0,C.separation>0&&(C.velocityBias=-60*C.separation);var N=d+-v*L-p- -b*B,U=f+v*R-x-b*P,K=V.normal.x*N+V.normal.y*U;K<-t.b2_velocityThreshold&&(C.velocityBias+=-V.restitution*K)}++l}},PreSolve:function(){for(var t,i,o=0;o<this.m_constraintCount;++o){var n=this.m_constraints[o],e=n.body1,s=n.body2,r=e.m_invMass,l=e.m_invI,a=s.m_invMass,m=s.m_invI,_=n.normal.x,h=n.normal.y,c=h,u=-_,y=0,p=0;if(W.s_enableWarmStarting)for(p=n.pointCount,y=0;y<p;++y){var x=n.points[y],d=x.normalImpulse*_+x.tangentImpulse*c,f=x.normalImpulse*h+x.tangentImpulse*u;i=e.m_R,t=x.localAnchor1;var b=i.col1.x*t.x+i.col2.x*t.y,v=i.col1.y*t.x+i.col2.y*t.y;i=s.m_R,t=x.localAnchor2;var g=i.col1.x*t.x+i.col2.x*t.y,A=i.col1.y*t.x+i.col2.y*t.y;e.m_angularVelocity-=l*(b*f-v*d),e.m_linearVelocity.x-=r*d,e.m_linearVelocity.y-=r*f,s.m_angularVelocity+=m*(g*f-A*d),s.m_linearVelocity.x+=a*d,s.m_linearVelocity.y+=a*f,x.positionImpulse=0}else for(p=n.pointCount,y=0;y<p;++y){var w=n.points[y];w.normalImpulse=0,w.tangentImpulse=0,w.positionImpulse=0}}},SolveVelocityConstraints:function(){for(var t,i,o,e,s,r,l,a,m,_,h,c,u,y=0,p=0;p<this.m_constraintCount;++p){var x=this.m_constraints[p],d=x.body1,f=x.body2,b=d.m_angularVelocity,v=d.m_linearVelocity,g=f.m_angularVelocity,A=f.m_linearVelocity,w=d.m_invMass,S=d.m_invI,V=f.m_invMass,M=f.m_invI,I=x.normal.x,C=x.normal.y,P=C,B=-I,R=x.pointCount;for(y=0;y<R;++y){t=x.points[y],c=d.m_R,u=t.localAnchor1,i=c.col1.x*u.x+c.col2.x*u.y,o=c.col1.y*u.x+c.col2.y*u.y,c=f.m_R,u=t.localAnchor2,e=c.col1.x*u.x+c.col2.x*u.y,s=c.col1.y*u.x+c.col2.y*u.y,r=A.x+-g*s-v.x- -b*o,l=A.y+g*e-v.y-b*i;var L=r*I+l*C;a=-t.normalMass*(L-t.velocityBias),m=n.b2Max(t.normalImpulse+a,0),a=m-t.normalImpulse,_=a*I,h=a*C,v.x-=w*_,v.y-=w*h,b-=S*(i*h-o*_),A.x+=V*_,A.y+=V*h,g+=M*(e*h-s*_),t.normalImpulse=m,r=A.x+-g*s-v.x- -b*o,l=A.y+g*e-v.y-b*i;var F=r*P+l*B;a=t.tangentMass*-F;var J=x.friction*t.normalImpulse;m=n.b2Clamp(t.tangentImpulse+a,-J,J),a=m-t.tangentImpulse,_=a*P,h=a*B,v.x-=w*_,v.y-=w*h,b-=S*(i*h-o*_),A.x+=V*_,A.y+=V*h,g+=M*(e*h-s*_),t.tangentImpulse=m}d.m_angularVelocity=b,f.m_angularVelocity=g}},SolvePositionConstraints:function(i){for(var o,e,s=0,r=0;r<this.m_constraintCount;++r){for(var l=this.m_constraints[r],a=l.body1,m=l.body2,_=a.m_position,h=a.m_rotation,c=m.m_position,u=m.m_rotation,y=a.m_invMass,p=a.m_invI,x=m.m_invMass,d=m.m_invI,f=l.normal.x,b=l.normal.y,v=l.pointCount,g=0;g<v;++g){var A=l.points[g];o=a.m_R,e=A.localAnchor1;var w=o.col1.x*e.x+o.col2.x*e.y,S=o.col1.y*e.x+o.col2.y*e.y;o=m.m_R,e=A.localAnchor2;var V=o.col1.x*e.x+o.col2.x*e.y,M=o.col1.y*e.x+o.col2.y*e.y,I=_.x+w,C=_.y+S,P=c.x+V,B=c.y+M,R=P-I,L=B-C,F=R*f+L*b+A.separation;s=n.b2Min(s,F);var J=i*n.b2Clamp(F+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),D=-A.normalMass*J,j=A.positionImpulse;A.positionImpulse=n.b2Max(j+D,0),D=A.positionImpulse-j;var O=D*f,T=D*b;_.x-=y*O,_.y-=y*T,h-=p*(w*T-S*O),a.m_R.Set(h),c.x+=x*O,c.y+=x*T,u+=d*(V*T-M*O),m.m_R.Set(u)}a.m_rotation=h,m.m_rotation=u}return s>=-t.b2_linearSlop},PostSolve:function(){for(var t=0;t<this.m_constraintCount;++t)for(var i=this.m_constraints[t],o=i.manifold,n=0;n<i.pointCount;++n){var e=o.points[n],s=i.points[n];e.normalImpulse=s.normalImpulse,e.tangentImpulse=s.tangentImpulse}},m_allocator:null,m_constraints:new Array,m_constraintCount:0};var q=l.create();Object.extend(q.prototype,T.prototype),Object.extend(q.prototype,{initialize:function(t,i){if(this.m_node1=new O,this.m_node2=new O,this.m_flags=0,!t||!i)return this.m_shape1=null,void(this.m_shape2=null);this.m_shape1=t,this.m_shape2=i,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=n.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null,this.m_manifold=[new b],this.m_manifold[0].pointCount=0,this.m_manifold[0].points[0].normalImpulse=0,this.m_manifold[0].points[0].tangentImpulse=0},Evaluate:function(){u.b2CollideCircle(this.m_manifold[0],this.m_shape1,this.m_shape2,!1),this.m_manifold[0].pointCount>0?this.m_manifoldCount=1:this.m_manifoldCount=0},GetManifolds:function(){return this.m_manifold},m_manifold:[new b]}),q.Create=function(t,i,o){return new q(t,i)},q.Destroy=function(t,i){};var N=l.create();N.prototype={initialize:function(){}},N.R1=new o,N.R2=new o,N.x1=new i,N.x2=new i,N.Conservative=function(i,o){var n=i.GetBody(),e=o.GetBody(),s=n.m_position.x-n.m_position0.x,r=n.m_position.y-n.m_position0.y,l=n.m_rotation-n.m_rotation0,a=e.m_position.x-e.m_position0.x,m=e.m_position.y-e.m_position0.y,_=e.m_rotation-e.m_rotation0,h=i.GetMaxRadius(),c=o.GetMaxRadius(),u=n.m_position0.x,y=n.m_position0.y,p=n.m_rotation0,x=e.m_position0.x,b=e.m_position0.y,v=e.m_rotation0,g=u,A=y,w=p,S=x,V=b,M=v;N.R1.Set(w),N.R2.Set(M),i.QuickSync(p1,N.R1),o.QuickSync(p2,N.R2);for(var I,C,P=0,B=10,R=0,L=!0,F=0;F<B;++F){var J=f.Distance(N.x1,N.x2,i,o);if(J<t.b2_linearSlop){L=0!=F;break}if(0==F){I=N.x2.x-N.x1.x,C=N.x2.y-N.x1.y;Math.sqrt(I*I+C*C);var D=I*(s-a)+C*(r-m)+Math.abs(l)*h+Math.abs(_)*c;if(Math.abs(D)<Number.MIN_VALUE){L=!1;break}R=1/D}var j=J*R,O=P+j;if(O<0||1<O){L=!1;break}if(O<(1+100*Number.MIN_VALUE)*P){L=!0;break}P=O,g=u+P*v1.x,A=y+P*v1.y,w=p+P*l,S=x+P*v2.x,V=b+P*v2.y,M=v+P*_,N.R1.Set(w),N.R2.Set(M),i.QuickSync(p1,N.R1),o.QuickSync(p2,N.R2)}if(L){I=N.x2.x-N.x1.x,C=N.x2.y-N.x1.y;var T=Math.sqrt(I*I+C*C);return T>FLT_EPSILON&&(d*=b2_linearSlop/T),n.IsStatic()?(n.m_position.x=g,n.m_position.y=A):(n.m_position.x=g-I,n.m_position.y=A-C),n.m_rotation=w,n.m_R.Set(w),n.QuickSyncShapes(),e.IsStatic()?(e.m_position.x=S,e.m_position.y=V):(e.m_position.x=S+I,e.m_position.y=V+C),e.m_position.x=S+I,e.m_position.y=V+C,e.m_rotation=M,e.m_R.Set(M),e.QuickSyncShapes(),!0}return i.QuickSync(n.m_position,n.m_R),o.QuickSync(e.m_position,e.m_R),!1};var U=l.create();Object.extend(U.prototype,T.prototype),Object.extend(U.prototype,{initialize:function(t,i){if(this.m_node1=new O,this.m_node2=new O,this.m_flags=0,!t||!i)return this.m_shape1=null,void(this.m_shape2=null);this.m_shape1=t,this.m_shape2=i,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=n.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null},Evaluate:function(){},GetManifolds:function(){return null}});var K=l.create();Object.extend(K.prototype,T.prototype),Object.extend(K.prototype,{initialize:function(i,o){if(this.m_node1=new O,this.m_node2=new O,this.m_flags=0,!i||!o)return this.m_shape1=null,void(this.m_shape2=null);this.m_shape1=i,this.m_shape2=o,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=n.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null,this.m_manifold=[new b],t.b2Assert(this.m_shape1.m_type==S.e_polyShape),t.b2Assert(this.m_shape2.m_type==S.e_circleShape),this.m_manifold[0].pointCount=0,this.m_manifold[0].points[0].normalImpulse=0,this.m_manifold[0].points[0].tangentImpulse=0},Evaluate:function(){u.b2CollidePolyAndCircle(this.m_manifold[0],this.m_shape1,this.m_shape2,!1),this.m_manifold[0].pointCount>0?this.m_manifoldCount=1:this.m_manifoldCount=0},GetManifolds:function(){return this.m_manifold},m_manifold:[new b]}),K.Create=function(t,i,o){return new K(t,i)},K.Destroy=function(t,i){};var X=l.create();Object.extend(X.prototype,T.prototype),Object.extend(X.prototype,{initialize:function(t,i){if(this.m_node1=new O,this.m_node2=new O,this.m_flags=0,!t||!i)return this.m_shape1=null,void(this.m_shape2=null);this.m_shape1=t,this.m_shape2=i,this.m_manifoldCount=0,this.m_friction=Math.sqrt(this.m_shape1.m_friction*this.m_shape2.m_friction),this.m_restitution=n.b2Max(this.m_shape1.m_restitution,this.m_shape2.m_restitution),this.m_prev=null,this.m_next=null,this.m_node1.contact=null,this.m_node1.prev=null,this.m_node1.next=null,this.m_node1.other=null,this.m_node2.contact=null,this.m_node2.prev=null,this.m_node2.next=null,this.m_node2.other=null,this.m0=new b,this.m_manifold=[new b],this.m_manifold[0].pointCount=0},m0:new b,Evaluate:function(){for(var t=this.m_manifold[0],i=this.m0.points,o=0;o<t.pointCount;o++){var n=i[o],e=t.points[o];n.normalImpulse=e.normalImpulse,n.tangentImpulse=e.tangentImpulse,n.id=e.id.Copy()}if(this.m0.pointCount=t.pointCount,u.b2CollidePoly(t,this.m_shape1,this.m_shape2,!1),t.pointCount>0){for(var s=[!1,!1],r=0;r<t.pointCount;++r){var l=t.points[r];l.normalImpulse=0,l.tangentImpulse=0;for(var a=l.id.key,m=0;m<this.m0.pointCount;++m)if(1!=s[m]){var _=this.m0.points[m],h=_.id;if(h.key==a){s[m]=!0,l.normalImpulse=_.normalImpulse,l.tangentImpulse=_.tangentImpulse;break}}}this.m_manifoldCount=1}else this.m_manifoldCount=0},GetManifolds:function(){return this.m_manifold},m_manifold:[new b]}),X.Create=function(t,i,o){return new X(t,i)},X.Destroy=function(t,i){};var H=l.create();Object.extend(H.prototype,m.prototype),Object.extend(H.prototype,{initialize:function(){this.m_nullContact=new U,this.m_world=null,this.m_destroyImmediate=!1},PairAdded:function(t,i){var o=t,n=i,e=o.m_body,s=n.m_body;if(e.IsStatic()&&s.IsStatic())return this.m_nullContact;if(o.m_body==n.m_body)return this.m_nullContact;if(s.IsConnected(e))return this.m_nullContact;if(null!=this.m_world.m_filter&&0==this.m_world.m_filter.ShouldCollide(o,n))return this.m_nullContact;if(0==s.m_invMass){var r=o;o=n,n=r;var l=e;e=s,s=l}var a=T.Create(o,n,this.m_world.m_blockAllocator);return null==a?this.m_nullContact:(a.m_prev=null,a.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=a),this.m_world.m_contactList=a,this.m_world.m_contactCount++,a)},PairRemoved:function(t,i,o){if(null!=o){var n=o;n!=this.m_nullContact&&(1==this.m_destroyImmediate?(this.DestroyContact(n),n=null):n.m_flags|=T.e_destroyFlag)}},DestroyContact:function(t){if(t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.GetManifoldCount()>0){var i=t.m_shape1.m_body,o=t.m_shape2.m_body,n=t.m_node1,e=t.m_node2;i.WakeUp(),o.WakeUp(),n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),n==i.m_contactList&&(i.m_contactList=n.next),n.prev=null,n.next=null,e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e==o.m_contactList&&(o.m_contactList=e.next),e.prev=null,e.next=null}T.Destroy(t,this.m_world.m_blockAllocator),--this.m_world.m_contactCount},CleanContactList:function(){var t=this.m_world.m_contactList;while(null!=t){var i=t;t=t.m_next,i.m_flags&T.e_destroyFlag&&(this.DestroyContact(i),i=null)}},Collide:function(){for(var t,i,o,n,e=this.m_world.m_contactList;null!=e;e=e.m_next)if(!e.m_shape1.m_body.IsSleeping()||!e.m_shape2.m_body.IsSleeping()){var s=e.GetManifoldCount();e.Evaluate();var r=e.GetManifoldCount();0==s&&r>0?(t=e.m_shape1.m_body,i=e.m_shape2.m_body,o=e.m_node1,n=e.m_node2,o.contact=e,o.other=i,o.prev=null,o.next=t.m_contactList,null!=o.next&&(o.next.prev=e.m_node1),t.m_contactList=e.m_node1,n.contact=e,n.other=t,n.prev=null,n.next=i.m_contactList,null!=n.next&&(n.next.prev=n),i.m_contactList=n):s>0&&0==r&&(t=e.m_shape1.m_body,i=e.m_shape2.m_body,o=e.m_node1,n=e.m_node2,o.prev&&(o.prev.next=o.next),o.next&&(o.next.prev=o.prev),o==t.m_contactList&&(t.m_contactList=o.next),o.prev=null,o.next=null,n.prev&&(n.prev.next=n.next),n.next&&(n.next.prev=n.prev),n==i.m_contactList&&(i.m_contactList=n.next),n.prev=null,n.next=null)}},m_world:null,m_nullContact:new U,m_destroyImmediate:null});var W=l.create();W.prototype={initialize:function(t,i,o){this.step=new j,this.m_contactManager=new H,this.m_listener=null,this.m_filter=J.b2_defaultFilter,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_bodyDestroyList=null,this.m_allowSleep=o,this.m_gravity=i,this.m_contactManager.m_world=this,this.m_broadPhase=new c(t,this.m_contactManager);var n=new F;this.m_groundBody=this.CreateBody(n)},SetListener:function(t){this.m_listener=t},SetFilter:function(t){this.m_filter=t},CreateBody:function(t){var i=new L(t,this);return i.m_prev=null,i.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=i),this.m_bodyList=i,++this.m_bodyCount,i},DestroyBody:function(t){t.m_flags&L.e_destroyFlag||(t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_flags|=L.e_destroyFlag,--this.m_bodyCount,t.m_prev=null,t.m_next=this.m_bodyDestroyList,this.m_bodyDestroyList=t)},CleanBodyList:function(){this.m_contactManager.m_destroyImmediate=!0;var t=this.m_bodyDestroyList;while(t){var i=t;t=t.m_next;var o=i.m_jointList;while(o){var n=o;o=o.next,this.m_listener&&this.m_listener.NotifyJointDestroyed(n.joint),this.DestroyJoint(n.joint)}i.Destroy()}this.m_bodyDestroyList=null,this.m_contactManager.m_destroyImmediate=!1},CreateJoint:function(t){var i=Z.Create(t,this.m_blockAllocator);if(i.m_prev=null,i.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=i),this.m_jointList=i,++this.m_jointCount,i.m_node1.joint=i,i.m_node1.other=i.m_body2,i.m_node1.prev=null,i.m_node1.next=i.m_body1.m_jointList,i.m_body1.m_jointList&&(i.m_body1.m_jointList.prev=i.m_node1),i.m_body1.m_jointList=i.m_node1,i.m_node2.joint=i,i.m_node2.other=i.m_body1,i.m_node2.prev=null,i.m_node2.next=i.m_body2.m_jointList,i.m_body2.m_jointList&&(i.m_body2.m_jointList.prev=i.m_node2),i.m_body2.m_jointList=i.m_node2,0==t.collideConnected)for(var o=t.body1.m_shapeCount<t.body2.m_shapeCount?t.body1:t.body2,n=o.m_shapeList;n;n=n.m_next)n.ResetProxy(this.m_broadPhase);return i},DestroyJoint:function(t){var i=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var o=t.m_body1,n=t.m_body2;if(o.WakeUp(),n.WakeUp(),t.m_node1.prev&&(t.m_node1.prev.next=t.m_node1.next),t.m_node1.next&&(t.m_node1.next.prev=t.m_node1.prev),t.m_node1==o.m_jointList&&(o.m_jointList=t.m_node1.next),t.m_node1.prev=null,t.m_node1.next=null,t.m_node2.prev&&(t.m_node2.prev.next=t.m_node2.next),t.m_node2.next&&(t.m_node2.next.prev=t.m_node2.prev),t.m_node2==n.m_jointList&&(n.m_jointList=t.m_node2.next),t.m_node2.prev=null,t.m_node2.next=null,Z.Destroy(t,this.m_blockAllocator),--this.m_jointCount,0==i)for(var e=o.m_shapeCount<n.m_shapeCount?o:n,s=e.m_shapeList;s;s=s.m_next)s.ResetProxy(this.m_broadPhase)},GetGroundBody:function(){return this.m_groundBody},step:new j,Step:function(t,i){var o,e;this.step.dt=t,this.step.iterations=i,this.step.inv_dt=t>0?1/t:0,this.m_positionIterationCount=0,this.m_contactManager.CleanContactList(),this.CleanBodyList(),this.m_contactManager.Collide();var s=new D(this.m_bodyCount,this.m_contactCount,this.m_jointCount,this.m_stackAllocator);for(o=this.m_bodyList;null!=o;o=o.m_next)o.m_flags&=~L.e_islandFlag;for(var r=this.m_contactList;null!=r;r=r.m_next)r.m_flags&=~T.e_islandFlag;for(var l=this.m_jointList;null!=l;l=l.m_next)l.m_islandFlag=!1;this.m_bodyCount;for(var a=new Array(this.m_bodyCount),m=0;m<this.m_bodyCount;m++)a[m]=null;for(var _=this.m_bodyList;null!=_;_=_.m_next)if(!(_.m_flags&(L.e_staticFlag|L.e_islandFlag|L.e_sleepFlag|L.e_frozenFlag))){s.Clear();var h=0;a[h++]=_,_.m_flags|=L.e_islandFlag;while(h>0)if(o=a[--h],s.AddBody(o),o.m_flags&=~L.e_sleepFlag,!(o.m_flags&L.e_staticFlag)){for(var c=o.m_contactList;null!=c;c=c.next)c.contact.m_flags&T.e_islandFlag||(s.AddContact(c.contact),c.contact.m_flags|=T.e_islandFlag,e=c.other,e.m_flags&L.e_islandFlag||(a[h++]=e,e.m_flags|=L.e_islandFlag));for(var u=o.m_jointList;null!=u;u=u.next)1!=u.joint.m_islandFlag&&(s.AddJoint(u.joint),u.joint.m_islandFlag=!0,e=u.other,e.m_flags&L.e_islandFlag||(a[h++]=e,e.m_flags|=L.e_islandFlag))}s.Solve(this.step,this.m_gravity),this.m_positionIterationCount=n.b2Max(this.m_positionIterationCount,D.m_positionIterationCount),this.m_allowSleep&&s.UpdateSleep(t);for(var y=0;y<s.m_bodyCount;++y)if(o=s.m_bodies[y],o.m_flags&L.e_staticFlag&&(o.m_flags&=~L.e_islandFlag),o.IsFrozen()&&this.m_listener){var p=this.m_listener.NotifyBoundaryViolated(o);p==Q.b2_destroyBody&&(this.DestroyBody(o),o=null,s.m_bodies[y]=null)}}this.m_broadPhase.Commit()},Query:function(t,i,o){for(var n=new Array,e=this.m_broadPhase.QueryAABB(t,n,o),s=0;s<e;++s)i[s]=n[s];return e},GetBodyList:function(){return this.m_bodyList},GetJointList:function(){return this.m_jointList},GetContactList:function(){return this.m_contactList},m_blockAllocator:null,m_stackAllocator:null,m_broadPhase:null,m_contactManager:new H,m_bodyList:null,m_contactList:null,m_jointList:null,m_bodyCount:0,m_contactCount:0,m_jointCount:0,m_bodyDestroyList:null,m_gravity:null,m_allowSleep:null,m_groundBody:null,m_listener:null,m_filter:null,m_positionIterationCount:0},W.s_enablePositionCorrection=1,W.s_enableWarmStarting=1;var Q=l.create();Q.prototype={NotifyJointDestroyed:function(t){},NotifyBoundaryViolated:function(t){return Q.b2_freezeBody},initialize:function(){}},Q.b2_freezeBody=0,Q.b2_destroyBody=1;var Y=l.create();Y.prototype={other:null,joint:null,prev:null,next:null,initialize:function(){}};var Z=l.create();Z.prototype={GetType:function(){return this.m_type},GetAnchor1:function(){return null},GetAnchor2:function(){return null},GetReactionForce:function(t){return null},GetReactionTorque:function(t){return 0},GetBody1:function(){return this.m_body1},GetBody2:function(){return this.m_body2},GetNext:function(){return this.m_next},GetUserData:function(){return this.m_userData},initialize:function(t){this.m_node1=new Y,this.m_node2=new Y,this.m_type=t.type,this.m_prev=null,this.m_next=null,this.m_body1=t.body1,this.m_body2=t.body2,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData},PrepareVelocitySolver:function(){},SolveVelocityConstraints:function(t){},PreparePositionSolver:function(){},SolvePositionConstraints:function(){return!1},m_type:0,m_prev:null,m_next:null,m_node1:new Y,m_node2:new Y,m_body1:null,m_body2:null,m_islandFlag:null,m_collideConnected:null,m_userData:null},Z.Create=function(t,i){var o=null;switch(t.type){case Z.e_distanceJoint:o=new tt(t);break;case Z.e_mouseJoint:o=new st(t);break;case Z.e_prismaticJoint:o=new lt(t);break;case Z.e_revoluteJoint:o=new ht(t);break;case Z.e_pulleyJoint:o=new mt(t);break;case Z.e_gearJoint:o=new nt(t);break;default:break}return o},Z.Destroy=function(t,i){},Z.e_unknownJoint=0,Z.e_revoluteJoint=1,Z.e_prismaticJoint=2,Z.e_distanceJoint=3,Z.e_pulleyJoint=4,Z.e_mouseJoint=5,Z.e_gearJoint=6,Z.e_inactiveLimit=0,Z.e_atLowerLimit=1,Z.e_atUpperLimit=2,Z.e_equalLimits=3;var $=l.create();$.prototype={initialize:function(){this.type=Z.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1},type:0,userData:null,body1:null,body2:null,collideConnected:null};var tt=l.create();Object.extend(tt.prototype,Z.prototype),Object.extend(tt.prototype,{initialize:function(t){var o,n,e;this.m_node1=new Y,this.m_node2=new Y,this.m_type=t.type,this.m_prev=null,this.m_next=null,this.m_body1=t.body1,this.m_body2=t.body2,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData,this.m_localAnchor1=new i,this.m_localAnchor2=new i,this.m_u=new i,o=this.m_body1.m_R,n=t.anchorPoint1.x-this.m_body1.m_position.x,e=t.anchorPoint1.y-this.m_body1.m_position.y,this.m_localAnchor1.x=n*o.col1.x+e*o.col1.y,this.m_localAnchor1.y=n*o.col2.x+e*o.col2.y,o=this.m_body2.m_R,n=t.anchorPoint2.x-this.m_body2.m_position.x,e=t.anchorPoint2.y-this.m_body2.m_position.y,this.m_localAnchor2.x=n*o.col1.x+e*o.col1.y,this.m_localAnchor2.y=n*o.col2.x+e*o.col2.y,n=t.anchorPoint2.x-t.anchorPoint1.x,e=t.anchorPoint2.y-t.anchorPoint1.y,this.m_length=Math.sqrt(n*n+e*e),this.m_impulse=0},PrepareVelocitySolver:function(){var i;i=this.m_body1.m_R;var o=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,n=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y;i=this.m_body2.m_R;var e=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,s=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y;this.m_u.x=this.m_body2.m_position.x+e-this.m_body1.m_position.x-o,this.m_u.y=this.m_body2.m_position.y+s-this.m_body1.m_position.y-n;var r=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);r>t.b2_linearSlop?this.m_u.Multiply(1/r):this.m_u.SetZero();var l=o*this.m_u.y-n*this.m_u.x,a=e*this.m_u.y-s*this.m_u.x;if(this.m_mass=this.m_body1.m_invMass+this.m_body1.m_invI*l*l+this.m_body2.m_invMass+this.m_body2.m_invI*a*a,this.m_mass=1/this.m_mass,W.s_enableWarmStarting){var m=this.m_impulse*this.m_u.x,_=this.m_impulse*this.m_u.y;this.m_body1.m_linearVelocity.x-=this.m_body1.m_invMass*m,this.m_body1.m_linearVelocity.y-=this.m_body1.m_invMass*_,this.m_body1.m_angularVelocity-=this.m_body1.m_invI*(o*_-n*m),this.m_body2.m_linearVelocity.x+=this.m_body2.m_invMass*m,this.m_body2.m_linearVelocity.y+=this.m_body2.m_invMass*_,this.m_body2.m_angularVelocity+=this.m_body2.m_invI*(e*_-s*m)}else this.m_impulse=0},SolveVelocityConstraints:function(t){var i;i=this.m_body1.m_R;var o=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,n=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y;i=this.m_body2.m_R;var e=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,s=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y,r=this.m_body1.m_linearVelocity.x+-this.m_body1.m_angularVelocity*n,l=this.m_body1.m_linearVelocity.y+this.m_body1.m_angularVelocity*o,a=this.m_body2.m_linearVelocity.x+-this.m_body2.m_angularVelocity*s,m=this.m_body2.m_linearVelocity.y+this.m_body2.m_angularVelocity*e,_=this.m_u.x*(a-r)+this.m_u.y*(m-l),h=-this.m_mass*_;this.m_impulse+=h;var c=h*this.m_u.x,u=h*this.m_u.y;this.m_body1.m_linearVelocity.x-=this.m_body1.m_invMass*c,this.m_body1.m_linearVelocity.y-=this.m_body1.m_invMass*u,this.m_body1.m_angularVelocity-=this.m_body1.m_invI*(o*u-n*c),this.m_body2.m_linearVelocity.x+=this.m_body2.m_invMass*c,this.m_body2.m_linearVelocity.y+=this.m_body2.m_invMass*u,this.m_body2.m_angularVelocity+=this.m_body2.m_invI*(e*u-s*c)},SolvePositionConstraints:function(){var i;i=this.m_body1.m_R;var o=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,e=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y;i=this.m_body2.m_R;var s=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,r=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y,l=this.m_body2.m_position.x+s-this.m_body1.m_position.x-o,a=this.m_body2.m_position.y+r-this.m_body1.m_position.y-e,m=Math.sqrt(l*l+a*a);l/=m,a/=m;var _=m-this.m_length;_=n.b2Clamp(_,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);var h=-this.m_mass*_;this.m_u.Set(l,a);var c=h*this.m_u.x,u=h*this.m_u.y;return this.m_body1.m_position.x-=this.m_body1.m_invMass*c,this.m_body1.m_position.y-=this.m_body1.m_invMass*u,this.m_body1.m_rotation-=this.m_body1.m_invI*(o*u-e*c),this.m_body2.m_position.x+=this.m_body2.m_invMass*c,this.m_body2.m_position.y+=this.m_body2.m_invMass*u,this.m_body2.m_rotation+=this.m_body2.m_invI*(s*u-r*c),this.m_body1.m_R.Set(this.m_body1.m_rotation),this.m_body2.m_R.Set(this.m_body2.m_rotation),n.b2Abs(_)<t.b2_linearSlop},GetAnchor1:function(){return n.AddVV(this.m_body1.m_position,n.b2MulMV(this.m_body1.m_R,this.m_localAnchor1))},GetAnchor2:function(){return n.AddVV(this.m_body2.m_position,n.b2MulMV(this.m_body2.m_R,this.m_localAnchor2))},GetReactionForce:function(t){var o=new i;return o.SetV(this.m_u),o.Multiply(this.m_impulse*t),o},GetReactionTorque:function(t){return 0},m_localAnchor1:new i,m_localAnchor2:new i,m_u:new i,m_impulse:null,m_mass:null,m_length:null});var it=l.create();Object.extend(it.prototype,$.prototype),Object.extend(it.prototype,{initialize:function(){this.type=Z.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.anchorPoint1=new i,this.anchorPoint2=new i,this.type=Z.e_distanceJoint},anchorPoint1:new i,anchorPoint2:new i});var ot=l.create();ot.prototype={linear1:new i,angular1:null,linear2:new i,angular2:null,SetZero:function(){this.linear1.SetZero(),this.angular1=0,this.linear2.SetZero(),this.angular2=0},Set:function(t,i,o,n){this.linear1.SetV(t),this.angular1=i,this.linear2.SetV(o),this.angular2=n},Compute:function(t,i,o,n){return this.linear1.x*t.x+this.linear1.y*t.y+this.angular1*i+(this.linear2.x*o.x+this.linear2.y*o.y)+this.angular2*n},initialize:function(){this.linear1=new i,this.linear2=new i}};var nt=l.create();Object.extend(nt.prototype,Z.prototype),Object.extend(nt.prototype,{GetAnchor1:function(){var t=this.m_body1.m_R;return new i(this.m_body1.m_position.x+(t.col1.x*this.m_localAnchor1.x+t.col2.x*this.m_localAnchor1.y),this.m_body1.m_position.y+(t.col1.y*this.m_localAnchor1.x+t.col2.y*this.m_localAnchor1.y))},GetAnchor2:function(){var t=this.m_body2.m_R;return new i(this.m_body2.m_position.x+(t.col1.x*this.m_localAnchor2.x+t.col2.x*this.m_localAnchor2.y),this.m_body2.m_position.y+(t.col1.y*this.m_localAnchor2.x+t.col2.y*this.m_localAnchor2.y))},GetReactionForce:function(t){return new i},GetReactionTorque:function(t){return 0},GetRatio:function(){return this.m_ratio},initialize:function(t){var o,n;this.m_node1=new Y,this.m_node2=new Y,this.m_type=t.type,this.m_prev=null,this.m_next=null,this.m_body1=t.body1,this.m_body2=t.body2,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData,this.m_groundAnchor1=new i,this.m_groundAnchor2=new i,this.m_localAnchor1=new i,this.m_localAnchor2=new i,this.m_J=new ot,this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null,this.m_ground1=t.joint1.m_body1,this.m_body1=t.joint1.m_body2,t.joint1.m_type==Z.e_revoluteJoint?(this.m_revolute1=t.joint1,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),o=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=t.joint1,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),o=this.m_prismatic1.GetJointTranslation()),this.m_ground2=t.joint2.m_body1,this.m_body2=t.joint2.m_body2,t.joint2.m_type==Z.e_revoluteJoint?(this.m_revolute2=t.joint2,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),n=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=t.joint2,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),n=this.m_prismatic2.GetJointTranslation()),this.m_ratio=t.ratio,this.m_constant=o+this.m_ratio*n,this.m_impulse=0},PrepareVelocitySolver:function(){var t,i,o,n,e,s,r,l=this.m_ground1,a=this.m_ground2,m=this.m_body1,_=this.m_body2,h=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angular1=-1,h+=m.m_invI):(e=l.m_R,s=this.m_prismatic1.m_localXAxis1,t=e.col1.x*s.x+e.col2.x*s.y,i=e.col1.y*s.x+e.col2.y*s.y,e=m.m_R,o=e.col1.x*this.m_localAnchor1.x+e.col2.x*this.m_localAnchor1.y,n=e.col1.y*this.m_localAnchor1.x+e.col2.y*this.m_localAnchor1.y,r=o*i-n*t,this.m_J.linear1.Set(-t,-i),this.m_J.angular1=-r,h+=m.m_invMass+m.m_invI*r*r),this.m_revolute2?(this.m_J.angular2=-this.m_ratio,h+=this.m_ratio*this.m_ratio*_.m_invI):(e=a.m_R,s=this.m_prismatic2.m_localXAxis1,t=e.col1.x*s.x+e.col2.x*s.y,i=e.col1.y*s.x+e.col2.y*s.y,e=_.m_R,o=e.col1.x*this.m_localAnchor2.x+e.col2.x*this.m_localAnchor2.y,n=e.col1.y*this.m_localAnchor2.x+e.col2.y*this.m_localAnchor2.y,r=o*i-n*t,this.m_J.linear2.Set(-this.m_ratio*t,-this.m_ratio*i),this.m_J.angular2=-this.m_ratio*r,h+=this.m_ratio*this.m_ratio*(_.m_invMass+_.m_invI*r*r)),this.m_mass=1/h,m.m_linearVelocity.x+=m.m_invMass*this.m_impulse*this.m_J.linear1.x,m.m_linearVelocity.y+=m.m_invMass*this.m_impulse*this.m_J.linear1.y,m.m_angularVelocity+=m.m_invI*this.m_impulse*this.m_J.angular1,_.m_linearVelocity.x+=_.m_invMass*this.m_impulse*this.m_J.linear2.x,_.m_linearVelocity.y+=_.m_invMass*this.m_impulse*this.m_J.linear2.y,_.m_angularVelocity+=_.m_invI*this.m_impulse*this.m_J.angular2},SolveVelocityConstraints:function(t){var i=this.m_body1,o=this.m_body2,n=this.m_J.Compute(i.m_linearVelocity,i.m_angularVelocity,o.m_linearVelocity,o.m_angularVelocity),e=-this.m_mass*n;this.m_impulse+=e,i.m_linearVelocity.x+=i.m_invMass*e*this.m_J.linear1.x,i.m_linearVelocity.y+=i.m_invMass*e*this.m_J.linear1.y,i.m_angularVelocity+=i.m_invI*e*this.m_J.angular1,o.m_linearVelocity.x+=o.m_invMass*e*this.m_J.linear2.x,o.m_linearVelocity.y+=o.m_invMass*e*this.m_J.linear2.y,o.m_angularVelocity+=o.m_invI*e*this.m_J.angular2},SolvePositionConstraints:function(){var i,o,n=0,e=this.m_body1,s=this.m_body2;i=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),o=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var r=this.m_constant-(i+this.m_ratio*o),l=-this.m_mass*r;return e.m_position.x+=e.m_invMass*l*this.m_J.linear1.x,e.m_position.y+=e.m_invMass*l*this.m_J.linear1.y,e.m_rotation+=e.m_invI*l*this.m_J.angular1,s.m_position.x+=s.m_invMass*l*this.m_J.linear2.x,s.m_position.y+=s.m_invMass*l*this.m_J.linear2.y,s.m_rotation+=s.m_invI*l*this.m_J.angular2,e.m_R.Set(e.m_rotation),s.m_R.Set(s.m_rotation),n<t.b2_linearSlop},m_ground1:null,m_ground2:null,m_revolute1:null,m_prismatic1:null,m_revolute2:null,m_prismatic2:null,m_groundAnchor1:new i,m_groundAnchor2:new i,m_localAnchor1:new i,m_localAnchor2:new i,m_J:new ot,m_constant:null,m_ratio:null,m_mass:null,m_impulse:null});var et=l.create();Object.extend(et.prototype,$.prototype),Object.extend(et.prototype,{initialize:function(){this.type=Z.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},joint1:null,joint2:null,ratio:null});var st=l.create();Object.extend(st.prototype,Z.prototype),Object.extend(st.prototype,{GetAnchor1:function(){return this.m_target},GetAnchor2:function(){var t=n.b2MulMV(this.m_body2.m_R,this.m_localAnchor);return t.Add(this.m_body2.m_position),t},GetReactionForce:function(t){var o=new i;return o.SetV(this.m_impulse),o.Multiply(t),o},GetReactionTorque:function(t){return 0},SetTarget:function(t){this.m_body2.WakeUp(),this.m_target=t},initialize:function(n){this.m_node1=new Y,this.m_node2=new Y,this.m_type=n.type,this.m_prev=null,this.m_next=null,this.m_body1=n.body1,this.m_body2=n.body2,this.m_collideConnected=n.collideConnected,this.m_islandFlag=!1,this.m_userData=n.userData,this.K=new o,this.K1=new o,this.K2=new o,this.m_localAnchor=new i,this.m_target=new i,this.m_impulse=new i,this.m_ptpMass=new o,this.m_C=new i,this.m_target.SetV(n.target);var e=this.m_target.x-this.m_body2.m_position.x,s=this.m_target.y-this.m_body2.m_position.y;this.m_localAnchor.x=e*this.m_body2.m_R.col1.x+s*this.m_body2.m_R.col1.y,this.m_localAnchor.y=e*this.m_body2.m_R.col2.x+s*this.m_body2.m_R.col2.y,this.m_maxForce=n.maxForce,this.m_impulse.SetZero();var r=this.m_body2.m_mass,l=2*t.b2_pi*n.frequencyHz,a=2*r*n.dampingRatio*l,m=r*l*l;this.m_gamma=1/(a+n.timeStep*m),this.m_beta=n.timeStep*m/(a+n.timeStep*m)},K:new o,K1:new o,K2:new o,PrepareVelocitySolver:function(){var t,i=this.m_body2;t=i.m_R;var o=t.col1.x*this.m_localAnchor.x+t.col2.x*this.m_localAnchor.y,n=t.col1.y*this.m_localAnchor.x+t.col2.y*this.m_localAnchor.y,e=i.m_invMass,s=i.m_invI;this.K1.col1.x=e,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=e,this.K2.col1.x=s*n*n,this.K2.col2.x=-s*o*n,this.K2.col1.y=-s*o*n,this.K2.col2.y=s*o*o,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.Invert(this.m_ptpMass),this.m_C.x=i.m_position.x+o-this.m_target.x,this.m_C.y=i.m_position.y+n-this.m_target.y,i.m_angularVelocity*=.98;var r=this.m_impulse.x,l=this.m_impulse.y;i.m_linearVelocity.x+=e*r,i.m_linearVelocity.y+=e*l,i.m_angularVelocity+=s*(o*l-n*r)},SolveVelocityConstraints:function(t){var i,o=this.m_body2;i=o.m_R;var n=i.col1.x*this.m_localAnchor.x+i.col2.x*this.m_localAnchor.y,e=i.col1.y*this.m_localAnchor.x+i.col2.y*this.m_localAnchor.y,s=o.m_linearVelocity.x+-o.m_angularVelocity*e,r=o.m_linearVelocity.y+o.m_angularVelocity*n;i=this.m_ptpMass;var l=s+this.m_beta*t.inv_dt*this.m_C.x+this.m_gamma*this.m_impulse.x,a=r+this.m_beta*t.inv_dt*this.m_C.y+this.m_gamma*this.m_impulse.y,m=-(i.col1.x*l+i.col2.x*a),_=-(i.col1.y*l+i.col2.y*a),h=this.m_impulse.x,c=this.m_impulse.y;this.m_impulse.x+=m,this.m_impulse.y+=_;var u=this.m_impulse.Length();u>t.dt*this.m_maxForce&&this.m_impulse.Multiply(t.dt*this.m_maxForce/u),m=this.m_impulse.x-h,_=this.m_impulse.y-c,o.m_linearVelocity.x+=o.m_invMass*m,o.m_linearVelocity.y+=o.m_invMass*_,o.m_angularVelocity+=o.m_invI*(n*_-e*m)},SolvePositionConstraints:function(){return!0},m_localAnchor:new i,m_target:new i,m_impulse:new i,m_ptpMass:new o,m_C:new i,m_maxForce:null,m_beta:null,m_gamma:null});var rt=l.create();Object.extend(rt.prototype,$.prototype),Object.extend(rt.prototype,{initialize:function(){this.type=Z.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.target=new i,this.type=Z.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7,this.timeStep=1/60},target:new i,maxForce:null,frequencyHz:null,dampingRatio:null,timeStep:null});var lt=l.create();Object.extend(lt.prototype,Z.prototype),Object.extend(lt.prototype,{GetAnchor1:function(){var t=this.m_body1,o=new i;return o.SetV(this.m_localAnchor1),o.MulM(t.m_R),o.Add(t.m_position),o},GetAnchor2:function(){var t=this.m_body2,o=new i;return o.SetV(this.m_localAnchor2),o.MulM(t.m_R),o.Add(t.m_position),o},GetJointTranslation:function(){var t,i=this.m_body1,o=this.m_body2;t=i.m_R;var n=t.col1.x*this.m_localAnchor1.x+t.col2.x*this.m_localAnchor1.y,e=t.col1.y*this.m_localAnchor1.x+t.col2.y*this.m_localAnchor1.y;t=o.m_R;var s=t.col1.x*this.m_localAnchor2.x+t.col2.x*this.m_localAnchor2.y,r=t.col1.y*this.m_localAnchor2.x+t.col2.y*this.m_localAnchor2.y,l=i.m_position.x+n,a=i.m_position.y+e,m=o.m_position.x+s,_=o.m_position.y+r,h=m-l,c=_-a;t=i.m_R;var u=t.col1.x*this.m_localXAxis1.x+t.col2.x*this.m_localXAxis1.y,y=t.col1.y*this.m_localXAxis1.x+t.col2.y*this.m_localXAxis1.y,p=u*h+y*c;return p},GetJointSpeed:function(){var t,i=this.m_body1,o=this.m_body2;t=i.m_R;var n=t.col1.x*this.m_localAnchor1.x+t.col2.x*this.m_localAnchor1.y,e=t.col1.y*this.m_localAnchor1.x+t.col2.y*this.m_localAnchor1.y;t=o.m_R;var s=t.col1.x*this.m_localAnchor2.x+t.col2.x*this.m_localAnchor2.y,r=t.col1.y*this.m_localAnchor2.x+t.col2.y*this.m_localAnchor2.y,l=i.m_position.x+n,a=i.m_position.y+e,m=o.m_position.x+s,_=o.m_position.y+r,h=m-l,c=_-a;t=i.m_R;var u=t.col1.x*this.m_localXAxis1.x+t.col2.x*this.m_localXAxis1.y,y=t.col1.y*this.m_localXAxis1.x+t.col2.y*this.m_localXAxis1.y,p=i.m_linearVelocity,x=o.m_linearVelocity,d=i.m_angularVelocity,f=o.m_angularVelocity,b=h*(-d*y)+c*(d*u)+(u*(x.x+-f*r-p.x- -d*e)+y*(x.y+f*s-p.y-d*n));return b},GetMotorForce:function(t){return t*this.m_motorImpulse},SetMotorSpeed:function(t){this.m_motorSpeed=t},SetMotorForce:function(t){this.m_maxMotorForce=t},GetReactionForce:function(t){var o,n=t*this.m_limitImpulse;o=this.m_body1.m_R;var e=n*(o.col1.x*this.m_localXAxis1.x+o.col2.x*this.m_localXAxis1.y),s=n*(o.col1.y*this.m_localXAxis1.x+o.col2.y*this.m_localXAxis1.y),r=n*(o.col1.x*this.m_localYAxis1.x+o.col2.x*this.m_localYAxis1.y),l=n*(o.col1.y*this.m_localYAxis1.x+o.col2.y*this.m_localYAxis1.y);return new i(e+r,s+l)},GetReactionTorque:function(t){return t*this.m_angularImpulse},initialize:function(t){var o,n,e;this.m_node1=new Y,this.m_node2=new Y,this.m_type=t.type,this.m_prev=null,this.m_next=null,this.m_body1=t.body1,this.m_body2=t.body2,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData,this.m_localAnchor1=new i,this.m_localAnchor2=new i,this.m_localXAxis1=new i,this.m_localYAxis1=new i,this.m_linearJacobian=new ot,this.m_motorJacobian=new ot,o=this.m_body1.m_R,n=t.anchorPoint.x-this.m_body1.m_position.x,e=t.anchorPoint.y-this.m_body1.m_position.y,this.m_localAnchor1.Set(n*o.col1.x+e*o.col1.y,n*o.col2.x+e*o.col2.y),o=this.m_body2.m_R,n=t.anchorPoint.x-this.m_body2.m_position.x,e=t.anchorPoint.y-this.m_body2.m_position.y,this.m_localAnchor2.Set(n*o.col1.x+e*o.col1.y,n*o.col2.x+e*o.col2.y),o=this.m_body1.m_R,n=t.axis.x,e=t.axis.y,this.m_localXAxis1.Set(n*o.col1.x+e*o.col1.y,n*o.col2.x+e*o.col2.y),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_initialAngle=this.m_body2.m_rotation-this.m_body1.m_rotation,this.m_linearJacobian.SetZero(),this.m_linearMass=0,this.m_linearImpulse=0,this.m_angularMass=0,this.m_angularImpulse=0,this.m_motorJacobian.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_limitImpulse=0,this.m_limitPositionImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.motorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor},PrepareVelocitySolver:function(){var i,o=this.m_body1,e=this.m_body2;i=o.m_R;var s=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,r=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y;i=e.m_R;var l=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,a=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y,m=o.m_invMass,_=e.m_invMass,h=o.m_invI,c=e.m_invI;i=o.m_R;var u=i.col1.x*this.m_localYAxis1.x+i.col2.x*this.m_localYAxis1.y,y=i.col1.y*this.m_localYAxis1.x+i.col2.y*this.m_localYAxis1.y,p=e.m_position.x+l-o.m_position.x,x=e.m_position.y+a-o.m_position.y;if(this.m_linearJacobian.linear1.x=-u,this.m_linearJacobian.linear1.y=-y,this.m_linearJacobian.linear2.x=u,this.m_linearJacobian.linear2.y=y,this.m_linearJacobian.angular1=-(p*y-x*u),this.m_linearJacobian.angular2=l*y-a*u,this.m_linearMass=m+h*this.m_linearJacobian.angular1*this.m_linearJacobian.angular1+_+c*this.m_linearJacobian.angular2*this.m_linearJacobian.angular2,this.m_linearMass=1/this.m_linearMass,this.m_angularMass=1/(h+c),this.m_enableLimit||this.m_enableMotor){i=o.m_R;var d=i.col1.x*this.m_localXAxis1.x+i.col2.x*this.m_localXAxis1.y,f=i.col1.y*this.m_localXAxis1.x+i.col2.y*this.m_localXAxis1.y;if(this.m_motorJacobian.linear1.x=-d,this.m_motorJacobian.linear1.y=-f,this.m_motorJacobian.linear2.x=d,this.m_motorJacobian.linear2.y=f,this.m_motorJacobian.angular1=-(p*f-x*d),this.m_motorJacobian.angular2=l*f-a*d,this.m_motorMass=m+h*this.m_motorJacobian.angular1*this.m_motorJacobian.angular1+_+c*this.m_motorJacobian.angular2*this.m_motorJacobian.angular2,this.m_motorMass=1/this.m_motorMass,this.m_enableLimit){var b=p-s,v=x-r,g=d*b+f*v;n.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=Z.e_equalLimits:g<=this.m_lowerTranslation?(this.m_limitState!=Z.e_atLowerLimit&&(this.m_limitImpulse=0),this.m_limitState=Z.e_atLowerLimit):g>=this.m_upperTranslation?(this.m_limitState!=Z.e_atUpperLimit&&(this.m_limitImpulse=0),this.m_limitState=Z.e_atUpperLimit):(this.m_limitState=Z.e_inactiveLimit,this.m_limitImpulse=0)}}if(0==this.m_enableMotor&&(this.m_motorImpulse=0),0==this.m_enableLimit&&(this.m_limitImpulse=0),W.s_enableWarmStarting){var A=this.m_linearImpulse*this.m_linearJacobian.linear1.x+(this.m_motorImpulse+this.m_limitImpulse)*this.m_motorJacobian.linear1.x,w=this.m_linearImpulse*this.m_linearJacobian.linear1.y+(this.m_motorImpulse+this.m_limitImpulse)*this.m_motorJacobian.linear1.y,S=this.m_linearImpulse*this.m_linearJacobian.linear2.x+(this.m_motorImpulse+this.m_limitImpulse)*this.m_motorJacobian.linear2.x,V=this.m_linearImpulse*this.m_linearJacobian.linear2.y+(this.m_motorImpulse+this.m_limitImpulse)*this.m_motorJacobian.linear2.y,M=this.m_linearImpulse*this.m_linearJacobian.angular1-this.m_angularImpulse+(this.m_motorImpulse+this.m_limitImpulse)*this.m_motorJacobian.angular1,I=this.m_linearImpulse*this.m_linearJacobian.angular2+this.m_angularImpulse+(this.m_motorImpulse+this.m_limitImpulse)*this.m_motorJacobian.angular2;o.m_linearVelocity.x+=m*A,o.m_linearVelocity.y+=m*w,o.m_angularVelocity+=h*M,e.m_linearVelocity.x+=_*S,e.m_linearVelocity.y+=_*V,e.m_angularVelocity+=c*I}else this.m_linearImpulse=0,this.m_angularImpulse=0,this.m_limitImpulse=0,this.m_motorImpulse=0;this.m_limitPositionImpulse=0},SolveVelocityConstraints:function(t){var i,o=this.m_body1,e=this.m_body2,s=o.m_invMass,r=e.m_invMass,l=o.m_invI,a=e.m_invI,m=this.m_linearJacobian.Compute(o.m_linearVelocity,o.m_angularVelocity,e.m_linearVelocity,e.m_angularVelocity),_=-this.m_linearMass*m;this.m_linearImpulse+=_,o.m_linearVelocity.x+=s*_*this.m_linearJacobian.linear1.x,o.m_linearVelocity.y+=s*_*this.m_linearJacobian.linear1.y,o.m_angularVelocity+=l*_*this.m_linearJacobian.angular1,e.m_linearVelocity.x+=r*_*this.m_linearJacobian.linear2.x,e.m_linearVelocity.y+=r*_*this.m_linearJacobian.linear2.y,e.m_angularVelocity+=a*_*this.m_linearJacobian.angular2;var h=e.m_angularVelocity-o.m_angularVelocity,c=-this.m_angularMass*h;if(this.m_angularImpulse+=c,o.m_angularVelocity-=l*c,e.m_angularVelocity+=a*c,this.m_enableMotor&&this.m_limitState!=Z.e_equalLimits){var u=this.m_motorJacobian.Compute(o.m_linearVelocity,o.m_angularVelocity,e.m_linearVelocity,e.m_angularVelocity)-this.m_motorSpeed,y=-this.m_motorMass*u,p=this.m_motorImpulse;this.m_motorImpulse=n.b2Clamp(this.m_motorImpulse+y,-t.dt*this.m_maxMotorForce,t.dt*this.m_maxMotorForce),y=this.m_motorImpulse-p,o.m_linearVelocity.x+=s*y*this.m_motorJacobian.linear1.x,o.m_linearVelocity.y+=s*y*this.m_motorJacobian.linear1.y,o.m_angularVelocity+=l*y*this.m_motorJacobian.angular1,e.m_linearVelocity.x+=r*y*this.m_motorJacobian.linear2.x,e.m_linearVelocity.y+=r*y*this.m_motorJacobian.linear2.y,e.m_angularVelocity+=a*y*this.m_motorJacobian.angular2}if(this.m_enableLimit&&this.m_limitState!=Z.e_inactiveLimit){var x=this.m_motorJacobian.Compute(o.m_linearVelocity,o.m_angularVelocity,e.m_linearVelocity,e.m_angularVelocity),d=-this.m_motorMass*x;this.m_limitState==Z.e_equalLimits?this.m_limitImpulse+=d:this.m_limitState==Z.e_atLowerLimit?(i=this.m_limitImpulse,this.m_limitImpulse=n.b2Max(this.m_limitImpulse+d,0),d=this.m_limitImpulse-i):this.m_limitState==Z.e_atUpperLimit&&(i=this.m_limitImpulse,this.m_limitImpulse=n.b2Min(this.m_limitImpulse+d,0),d=this.m_limitImpulse-i),o.m_linearVelocity.x+=s*d*this.m_motorJacobian.linear1.x,o.m_linearVelocity.y+=s*d*this.m_motorJacobian.linear1.y,o.m_angularVelocity+=l*d*this.m_motorJacobian.angular1,e.m_linearVelocity.x+=r*d*this.m_motorJacobian.linear2.x,e.m_linearVelocity.y+=r*d*this.m_motorJacobian.linear2.y,e.m_angularVelocity+=a*d*this.m_motorJacobian.angular2}},SolvePositionConstraints:function(){var i,o,e,s=this.m_body1,r=this.m_body2,l=s.m_invMass,a=r.m_invMass,m=s.m_invI,_=r.m_invI;e=s.m_R;var h=e.col1.x*this.m_localAnchor1.x+e.col2.x*this.m_localAnchor1.y,c=e.col1.y*this.m_localAnchor1.x+e.col2.y*this.m_localAnchor1.y;e=r.m_R;var u=e.col1.x*this.m_localAnchor2.x+e.col2.x*this.m_localAnchor2.y,y=e.col1.y*this.m_localAnchor2.x+e.col2.y*this.m_localAnchor2.y,p=s.m_position.x+h,x=s.m_position.y+c,d=r.m_position.x+u,f=r.m_position.y+y,b=d-p,v=f-x;e=s.m_R;var g=e.col1.x*this.m_localYAxis1.x+e.col2.x*this.m_localYAxis1.y,A=e.col1.y*this.m_localYAxis1.x+e.col2.y*this.m_localYAxis1.y,w=g*b+A*v;w=n.b2Clamp(w,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);var S=-this.m_linearMass*w;s.m_position.x+=l*S*this.m_linearJacobian.linear1.x,s.m_position.y+=l*S*this.m_linearJacobian.linear1.y,s.m_rotation+=m*S*this.m_linearJacobian.angular1,r.m_position.x+=a*S*this.m_linearJacobian.linear2.x,r.m_position.y+=a*S*this.m_linearJacobian.linear2.y,r.m_rotation+=_*S*this.m_linearJacobian.angular2;var V=n.b2Abs(w),M=r.m_rotation-s.m_rotation-this.m_initialAngle;M=n.b2Clamp(M,-t.b2_maxAngularCorrection,t.b2_maxAngularCorrection);var I=-this.m_angularMass*M;s.m_rotation-=s.m_invI*I,s.m_R.Set(s.m_rotation),r.m_rotation+=r.m_invI*I,r.m_R.Set(r.m_rotation);var C=n.b2Abs(M);if(this.m_enableLimit&&this.m_limitState!=Z.e_inactiveLimit){e=s.m_R,h=e.col1.x*this.m_localAnchor1.x+e.col2.x*this.m_localAnchor1.y,c=e.col1.y*this.m_localAnchor1.x+e.col2.y*this.m_localAnchor1.y,e=r.m_R,u=e.col1.x*this.m_localAnchor2.x+e.col2.x*this.m_localAnchor2.y,y=e.col1.y*this.m_localAnchor2.x+e.col2.y*this.m_localAnchor2.y,p=s.m_position.x+h,x=s.m_position.y+c,d=r.m_position.x+u,f=r.m_position.y+y,b=d-p,v=f-x,e=s.m_R;var P=e.col1.x*this.m_localXAxis1.x+e.col2.x*this.m_localXAxis1.y,B=e.col1.y*this.m_localXAxis1.x+e.col2.y*this.m_localXAxis1.y,R=P*b+B*v,L=0;this.m_limitState==Z.e_equalLimits?(i=n.b2Clamp(R,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),L=-this.m_motorMass*i,V=n.b2Max(V,n.b2Abs(M))):this.m_limitState==Z.e_atLowerLimit?(i=R-this.m_lowerTranslation,V=n.b2Max(V,-i),i=n.b2Clamp(i+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),L=-this.m_motorMass*i,o=this.m_limitPositionImpulse,this.m_limitPositionImpulse=n.b2Max(this.m_limitPositionImpulse+L,0),L=this.m_limitPositionImpulse-o):this.m_limitState==Z.e_atUpperLimit&&(i=R-this.m_upperTranslation,V=n.b2Max(V,i),i=n.b2Clamp(i-t.b2_linearSlop,0,t.b2_maxLinearCorrection),L=-this.m_motorMass*i,o=this.m_limitPositionImpulse,this.m_limitPositionImpulse=n.b2Min(this.m_limitPositionImpulse+L,0),L=this.m_limitPositionImpulse-o),s.m_position.x+=l*L*this.m_motorJacobian.linear1.x,s.m_position.y+=l*L*this.m_motorJacobian.linear1.y,s.m_rotation+=m*L*this.m_motorJacobian.angular1,s.m_R.Set(s.m_rotation),r.m_position.x+=a*L*this.m_motorJacobian.linear2.x,r.m_position.y+=a*L*this.m_motorJacobian.linear2.y,r.m_rotation+=_*L*this.m_motorJacobian.angular2,r.m_R.Set(r.m_rotation)}return V<=t.b2_linearSlop&&C<=t.b2_angularSlop},m_localAnchor1:new i,m_localAnchor2:new i,m_localXAxis1:new i,m_localYAxis1:new i,m_initialAngle:null,m_linearJacobian:new ot,m_linearMass:null,m_linearImpulse:null,m_angularMass:null,m_angularImpulse:null,m_motorJacobian:new ot,m_motorMass:null,m_motorImpulse:null,m_limitImpulse:null,m_limitPositionImpulse:null,m_lowerTranslation:null,m_upperTranslation:null,m_maxMotorForce:null,m_motorSpeed:null,m_enableLimit:null,m_enableMotor:null,m_limitState:0});var at=l.create();Object.extend(at.prototype,$.prototype),Object.extend(at.prototype,{initialize:function(){this.type=Z.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.type=Z.e_prismaticJoint,this.anchorPoint=new i(0,0),this.axis=new i(0,0),this.lowerTranslation=0,this.upperTranslation=0,this.motorForce=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},anchorPoint:null,axis:null,lowerTranslation:null,upperTranslation:null,motorForce:null,motorSpeed:null,enableLimit:null,enableMotor:null});var mt=l.create();Object.extend(mt.prototype,Z.prototype),Object.extend(mt.prototype,{GetAnchor1:function(){var t=this.m_body1.m_R;return new i(this.m_body1.m_position.x+(t.col1.x*this.m_localAnchor1.x+t.col2.x*this.m_localAnchor1.y),this.m_body1.m_position.y+(t.col1.y*this.m_localAnchor1.x+t.col2.y*this.m_localAnchor1.y))},GetAnchor2:function(){var t=this.m_body2.m_R;return new i(this.m_body2.m_position.x+(t.col1.x*this.m_localAnchor2.x+t.col2.x*this.m_localAnchor2.y),this.m_body2.m_position.y+(t.col1.y*this.m_localAnchor2.x+t.col2.y*this.m_localAnchor2.y))},GetGroundPoint1:function(){return new i(this.m_ground.m_position.x+this.m_groundAnchor1.x,this.m_ground.m_position.y+this.m_groundAnchor1.y)},GetGroundPoint2:function(){return new i(this.m_ground.m_position.x+this.m_groundAnchor2.x,this.m_ground.m_position.y+this.m_groundAnchor2.y)},GetReactionForce:function(t){return new i},GetReactionTorque:function(t){return 0},GetLength1:function(){var t;t=this.m_body1.m_R;var i=this.m_body1.m_position.x+(t.col1.x*this.m_localAnchor1.x+t.col2.x*this.m_localAnchor1.y),o=this.m_body1.m_position.y+(t.col1.y*this.m_localAnchor1.x+t.col2.y*this.m_localAnchor1.y),n=i-(this.m_ground.m_position.x+this.m_groundAnchor1.x),e=o-(this.m_ground.m_position.y+this.m_groundAnchor1.y);return Math.sqrt(n*n+e*e)},GetLength2:function(){var t;t=this.m_body2.m_R;var i=this.m_body2.m_position.x+(t.col1.x*this.m_localAnchor2.x+t.col2.x*this.m_localAnchor2.y),o=this.m_body2.m_position.y+(t.col1.y*this.m_localAnchor2.x+t.col2.y*this.m_localAnchor2.y),n=i-(this.m_ground.m_position.x+this.m_groundAnchor2.x),e=o-(this.m_ground.m_position.y+this.m_groundAnchor2.y);return Math.sqrt(n*n+e*e)},GetRatio:function(){return this.m_ratio},initialize:function(t){var o,e,s;this.m_node1=new Y,this.m_node2=new Y,this.m_type=t.type,this.m_prev=null,this.m_next=null,this.m_body1=t.body1,this.m_body2=t.body2,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData,this.m_groundAnchor1=new i,this.m_groundAnchor2=new i,this.m_localAnchor1=new i,this.m_localAnchor2=new i,this.m_u1=new i,this.m_u2=new i,this.m_ground=this.m_body1.m_world.m_groundBody,this.m_groundAnchor1.x=t.groundPoint1.x-this.m_ground.m_position.x,this.m_groundAnchor1.y=t.groundPoint1.y-this.m_ground.m_position.y,this.m_groundAnchor2.x=t.groundPoint2.x-this.m_ground.m_position.x,this.m_groundAnchor2.y=t.groundPoint2.y-this.m_ground.m_position.y,o=this.m_body1.m_R,e=t.anchorPoint1.x-this.m_body1.m_position.x,s=t.anchorPoint1.y-this.m_body1.m_position.y,this.m_localAnchor1.x=e*o.col1.x+s*o.col1.y,this.m_localAnchor1.y=e*o.col2.x+s*o.col2.y,o=this.m_body2.m_R,e=t.anchorPoint2.x-this.m_body2.m_position.x,s=t.anchorPoint2.y-this.m_body2.m_position.y,this.m_localAnchor2.x=e*o.col1.x+s*o.col1.y,this.m_localAnchor2.y=e*o.col2.x+s*o.col2.y,this.m_ratio=t.ratio,e=t.groundPoint1.x-t.anchorPoint1.x,s=t.groundPoint1.y-t.anchorPoint1.y;var r=Math.sqrt(e*e+s*s);e=t.groundPoint2.x-t.anchorPoint2.x,s=t.groundPoint2.y-t.anchorPoint2.y;var l=Math.sqrt(e*e+s*s),a=n.b2Max(.5*mt.b2_minPulleyLength,r),m=n.b2Max(.5*mt.b2_minPulleyLength,l);this.m_constant=a+this.m_ratio*m,this.m_maxLength1=n.b2Clamp(t.maxLength1,a,this.m_constant-this.m_ratio*mt.b2_minPulleyLength),this.m_maxLength2=n.b2Clamp(t.maxLength2,m,(this.m_constant-mt.b2_minPulleyLength)/this.m_ratio),this.m_pulleyImpulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},PrepareVelocitySolver:function(){var i,o=this.m_body1,n=this.m_body2;i=o.m_R;var e=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,s=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y;i=n.m_R;var r=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,l=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y,a=o.m_position.x+e,m=o.m_position.y+s,_=n.m_position.x+r,h=n.m_position.y+l,c=this.m_ground.m_position.x+this.m_groundAnchor1.x,u=this.m_ground.m_position.y+this.m_groundAnchor1.y,y=this.m_ground.m_position.x+this.m_groundAnchor2.x,p=this.m_ground.m_position.y+this.m_groundAnchor2.y;this.m_u1.Set(a-c,m-u),this.m_u2.Set(_-y,h-p);var x=this.m_u1.Length(),d=this.m_u2.Length();x>t.b2_linearSlop?this.m_u1.Multiply(1/x):this.m_u1.SetZero(),d>t.b2_linearSlop?this.m_u2.Multiply(1/d):this.m_u2.SetZero(),x<this.m_maxLength1?(this.m_limitState1=Z.e_inactiveLimit,this.m_limitImpulse1=0):(this.m_limitState1=Z.e_atUpperLimit,this.m_limitPositionImpulse1=0),d<this.m_maxLength2?(this.m_limitState2=Z.e_inactiveLimit,this.m_limitImpulse2=0):(this.m_limitState2=Z.e_atUpperLimit,this.m_limitPositionImpulse2=0);var f=e*this.m_u1.y-s*this.m_u1.x,b=r*this.m_u2.y-l*this.m_u2.x;this.m_limitMass1=o.m_invMass+o.m_invI*f*f,this.m_limitMass2=n.m_invMass+n.m_invI*b*b,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass;var v=(-this.m_pulleyImpulse-this.m_limitImpulse1)*this.m_u1.x,g=(-this.m_pulleyImpulse-this.m_limitImpulse1)*this.m_u1.y,A=(-this.m_ratio*this.m_pulleyImpulse-this.m_limitImpulse2)*this.m_u2.x,w=(-this.m_ratio*this.m_pulleyImpulse-this.m_limitImpulse2)*this.m_u2.y;o.m_linearVelocity.x+=o.m_invMass*v,o.m_linearVelocity.y+=o.m_invMass*g,o.m_angularVelocity+=o.m_invI*(e*g-s*v),n.m_linearVelocity.x+=n.m_invMass*A,n.m_linearVelocity.y+=n.m_invMass*w,n.m_angularVelocity+=n.m_invI*(r*w-l*A)},SolveVelocityConstraints:function(t){var i,o=this.m_body1,e=this.m_body2;i=o.m_R;var s=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,r=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y;i=e.m_R;var l,a,m,_,h,c,u,y,p,x,d,f=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,b=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y;l=o.m_linearVelocity.x+-o.m_angularVelocity*r,a=o.m_linearVelocity.y+o.m_angularVelocity*s,m=e.m_linearVelocity.x+-e.m_angularVelocity*b,_=e.m_linearVelocity.y+e.m_angularVelocity*f,p=-(this.m_u1.x*l+this.m_u1.y*a)-this.m_ratio*(this.m_u2.x*m+this.m_u2.y*_),x=-this.m_pulleyMass*p,this.m_pulleyImpulse+=x,h=-x*this.m_u1.x,c=-x*this.m_u1.y,u=-this.m_ratio*x*this.m_u2.x,y=-this.m_ratio*x*this.m_u2.y,o.m_linearVelocity.x+=o.m_invMass*h,o.m_linearVelocity.y+=o.m_invMass*c,o.m_angularVelocity+=o.m_invI*(s*c-r*h),e.m_linearVelocity.x+=e.m_invMass*u,e.m_linearVelocity.y+=e.m_invMass*y,e.m_angularVelocity+=e.m_invI*(f*y-b*u),this.m_limitState1==Z.e_atUpperLimit&&(l=o.m_linearVelocity.x+-o.m_angularVelocity*r,a=o.m_linearVelocity.y+o.m_angularVelocity*s,p=-(this.m_u1.x*l+this.m_u1.y*a),x=-this.m_limitMass1*p,d=this.m_limitImpulse1,this.m_limitImpulse1=n.b2Max(0,this.m_limitImpulse1+x),x=this.m_limitImpulse1-d,h=-x*this.m_u1.x,c=-x*this.m_u1.y,o.m_linearVelocity.x+=o.m_invMass*h,o.m_linearVelocity.y+=o.m_invMass*c,o.m_angularVelocity+=o.m_invI*(s*c-r*h)),this.m_limitState2==Z.e_atUpperLimit&&(m=e.m_linearVelocity.x+-e.m_angularVelocity*b,_=e.m_linearVelocity.y+e.m_angularVelocity*f,p=-(this.m_u2.x*m+this.m_u2.y*_),x=-this.m_limitMass2*p,d=this.m_limitImpulse2,this.m_limitImpulse2=n.b2Max(0,this.m_limitImpulse2+x),x=this.m_limitImpulse2-d,u=-x*this.m_u2.x,y=-x*this.m_u2.y,e.m_linearVelocity.x+=e.m_invMass*u,e.m_linearVelocity.y+=e.m_invMass*y,e.m_angularVelocity+=e.m_invI*(f*y-b*u))},SolvePositionConstraints:function(){var i,o,e,s,r,l,a,m,_,h,c,u,y,p,x=this.m_body1,d=this.m_body2,f=this.m_ground.m_position.x+this.m_groundAnchor1.x,b=this.m_ground.m_position.y+this.m_groundAnchor1.y,v=this.m_ground.m_position.x+this.m_groundAnchor2.x,g=this.m_ground.m_position.y+this.m_groundAnchor2.y,A=0;return i=x.m_R,o=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,e=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y,i=d.m_R,s=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,r=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y,l=x.m_position.x+o,a=x.m_position.y+e,m=d.m_position.x+s,_=d.m_position.y+r,this.m_u1.Set(l-f,a-b),this.m_u2.Set(m-v,_-g),h=this.m_u1.Length(),c=this.m_u2.Length(),h>t.b2_linearSlop?this.m_u1.Multiply(1/h):this.m_u1.SetZero(),c>t.b2_linearSlop?this.m_u2.Multiply(1/c):this.m_u2.SetZero(),u=this.m_constant-h-this.m_ratio*c,A=n.b2Max(A,Math.abs(u)),u=n.b2Clamp(u,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),y=-this.m_pulleyMass*u,l=-y*this.m_u1.x,a=-y*this.m_u1.y,m=-this.m_ratio*y*this.m_u2.x,_=-this.m_ratio*y*this.m_u2.y,x.m_position.x+=x.m_invMass*l,x.m_position.y+=x.m_invMass*a,x.m_rotation+=x.m_invI*(o*a-e*l),d.m_position.x+=d.m_invMass*m,d.m_position.y+=d.m_invMass*_,d.m_rotation+=d.m_invI*(s*_-r*m),x.m_R.Set(x.m_rotation),d.m_R.Set(d.m_rotation),this.m_limitState1==Z.e_atUpperLimit&&(i=x.m_R,o=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,e=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y,l=x.m_position.x+o,a=x.m_position.y+e,this.m_u1.Set(l-f,a-b),h=this.m_u1.Length(),h>t.b2_linearSlop?(this.m_u1.x*=1/h,this.m_u1.y*=1/h):this.m_u1.SetZero(),u=this.m_maxLength1-h,A=n.b2Max(A,-u),u=n.b2Clamp(u+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),y=-this.m_limitMass1*u,p=this.m_limitPositionImpulse1,this.m_limitPositionImpulse1=n.b2Max(0,this.m_limitPositionImpulse1+y),y=this.m_limitPositionImpulse1-p,l=-y*this.m_u1.x,a=-y*this.m_u1.y,x.m_position.x+=x.m_invMass*l,x.m_position.y+=x.m_invMass*a,x.m_rotation+=x.m_invI*(o*a-e*l),x.m_R.Set(x.m_rotation)),this.m_limitState2==Z.e_atUpperLimit&&(i=d.m_R,s=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,r=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y,m=d.m_position.x+s,_=d.m_position.y+r,this.m_u2.Set(m-v,_-g),c=this.m_u2.Length(),c>t.b2_linearSlop?(this.m_u2.x*=1/c,this.m_u2.y*=1/c):this.m_u2.SetZero(),u=this.m_maxLength2-c,A=n.b2Max(A,-u),u=n.b2Clamp(u+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),y=-this.m_limitMass2*u,p=this.m_limitPositionImpulse2,this.m_limitPositionImpulse2=n.b2Max(0,this.m_limitPositionImpulse2+y),y=this.m_limitPositionImpulse2-p,m=-y*this.m_u2.x,_=-y*this.m_u2.y,d.m_position.x+=d.m_invMass*m,d.m_position.y+=d.m_invMass*_,d.m_rotation+=d.m_invI*(s*_-r*m),d.m_R.Set(d.m_rotation)),A<t.b2_linearSlop},m_ground:null,m_groundAnchor1:new i,m_groundAnchor2:new i,m_localAnchor1:new i,m_localAnchor2:new i,m_u1:new i,m_u2:new i,m_constant:null,m_ratio:null,m_maxLength1:null,m_maxLength2:null,m_pulleyMass:null,m_limitMass1:null,m_limitMass2:null,m_pulleyImpulse:null,m_limitImpulse1:null,m_limitImpulse2:null,m_limitPositionImpulse1:null,m_limitPositionImpulse2:null,m_limitState1:0,m_limitState2:0}),mt.b2_minPulleyLength=t.b2_lengthUnitsPerMeter;var _t=l.create();Object.extend(_t.prototype,$.prototype),Object.extend(_t.prototype,{initialize:function(){this.type=Z.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.groundPoint1=new i,this.groundPoint2=new i,this.anchorPoint1=new i,this.anchorPoint2=new i,this.type=Z.e_pulleyJoint,this.groundPoint1.Set(-1,1),this.groundPoint2.Set(1,1),this.anchorPoint1.Set(-1,0),this.anchorPoint2.Set(1,0),this.maxLength1=.5*mt.b2_minPulleyLength,this.maxLength2=.5*mt.b2_minPulleyLength,this.ratio=1,this.collideConnected=!0},groundPoint1:new i,groundPoint2:new i,anchorPoint1:new i,anchorPoint2:new i,maxLength1:null,maxLength2:null,ratio:null});var ht=l.create();Object.extend(ht.prototype,Z.prototype),Object.extend(ht.prototype,{GetAnchor1:function(){var t=this.m_body1.m_R;return new i(this.m_body1.m_position.x+(t.col1.x*this.m_localAnchor1.x+t.col2.x*this.m_localAnchor1.y),this.m_body1.m_position.y+(t.col1.y*this.m_localAnchor1.x+t.col2.y*this.m_localAnchor1.y))},GetAnchor2:function(){var t=this.m_body2.m_R;return new i(this.m_body2.m_position.x+(t.col1.x*this.m_localAnchor2.x+t.col2.x*this.m_localAnchor2.y),this.m_body2.m_position.y+(t.col1.y*this.m_localAnchor2.x+t.col2.y*this.m_localAnchor2.y))},GetJointAngle:function(){return this.m_body2.m_rotation-this.m_body1.m_rotation},GetJointSpeed:function(){return this.m_body2.m_angularVelocity-this.m_body1.m_angularVelocity},GetMotorTorque:function(t){return t*this.m_motorImpulse},SetMotorSpeed:function(t){this.m_motorSpeed=t},SetMotorTorque:function(t){this.m_maxMotorTorque=t},GetReactionForce:function(t){var i=this.m_ptpImpulse.Copy();return i.Multiply(t),i},GetReactionTorque:function(t){return t*this.m_limitImpulse},initialize:function(t){var n,e,s;this.m_node1=new Y,this.m_node2=new Y,this.m_type=t.type,this.m_prev=null,this.m_next=null,this.m_body1=t.body1,this.m_body2=t.body2,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData,this.K=new o,this.K1=new o,this.K2=new o,this.K3=new o,this.m_localAnchor1=new i,this.m_localAnchor2=new i,this.m_ptpImpulse=new i,this.m_ptpMass=new o,n=this.m_body1.m_R,e=t.anchorPoint.x-this.m_body1.m_position.x,s=t.anchorPoint.y-this.m_body1.m_position.y,this.m_localAnchor1.x=e*n.col1.x+s*n.col1.y,this.m_localAnchor1.y=e*n.col2.x+s*n.col2.y,n=this.m_body2.m_R,e=t.anchorPoint.x-this.m_body2.m_position.x,s=t.anchorPoint.y-this.m_body2.m_position.y,this.m_localAnchor2.x=e*n.col1.x+s*n.col1.y,this.m_localAnchor2.y=e*n.col2.x+s*n.col2.y,this.m_intialAngle=this.m_body2.m_rotation-this.m_body1.m_rotation,this.m_ptpImpulse.Set(0,0),this.m_motorImpulse=0,this.m_limitImpulse=0,this.m_limitPositionImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.motorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor},K:new o,K1:new o,K2:new o,K3:new o,PrepareVelocitySolver:function(){var i,o=this.m_body1,e=this.m_body2;i=o.m_R;var s=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,r=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y;i=e.m_R;var l=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,a=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y,m=o.m_invMass,_=e.m_invMass,h=o.m_invI,c=e.m_invI;if(this.K1.col1.x=m+_,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=m+_,this.K2.col1.x=h*r*r,this.K2.col2.x=-h*s*r,this.K2.col1.y=-h*s*r,this.K2.col2.y=h*s*s,this.K3.col1.x=c*a*a,this.K3.col2.x=-c*l*a,this.K3.col1.y=-c*l*a,this.K3.col2.y=c*l*l,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Invert(this.m_ptpMass),this.m_motorMass=1/(h+c),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var u=e.m_rotation-o.m_rotation-this.m_intialAngle;n.b2Abs(this.m_upperAngle-this.m_lowerAngle)<2*t.b2_angularSlop?this.m_limitState=Z.e_equalLimits:u<=this.m_lowerAngle?(this.m_limitState!=Z.e_atLowerLimit&&(this.m_limitImpulse=0),this.m_limitState=Z.e_atLowerLimit):u>=this.m_upperAngle?(this.m_limitState!=Z.e_atUpperLimit&&(this.m_limitImpulse=0),this.m_limitState=Z.e_atUpperLimit):(this.m_limitState=Z.e_inactiveLimit,this.m_limitImpulse=0)}else this.m_limitImpulse=0;W.s_enableWarmStarting?(o.m_linearVelocity.x-=m*this.m_ptpImpulse.x,o.m_linearVelocity.y-=m*this.m_ptpImpulse.y,o.m_angularVelocity-=h*(s*this.m_ptpImpulse.y-r*this.m_ptpImpulse.x+this.m_motorImpulse+this.m_limitImpulse),e.m_linearVelocity.x+=_*this.m_ptpImpulse.x,e.m_linearVelocity.y+=_*this.m_ptpImpulse.y,e.m_angularVelocity+=c*(l*this.m_ptpImpulse.y-a*this.m_ptpImpulse.x+this.m_motorImpulse+this.m_limitImpulse)):(this.m_ptpImpulse.SetZero(),this.m_motorImpulse=0,this.m_limitImpulse=0),this.m_limitPositionImpulse=0},SolveVelocityConstraints:function(t){var i,o=this.m_body1,e=this.m_body2;i=o.m_R;var s=i.col1.x*this.m_localAnchor1.x+i.col2.x*this.m_localAnchor1.y,r=i.col1.y*this.m_localAnchor1.x+i.col2.y*this.m_localAnchor1.y;i=e.m_R;var l,a=i.col1.x*this.m_localAnchor2.x+i.col2.x*this.m_localAnchor2.y,m=i.col1.y*this.m_localAnchor2.x+i.col2.y*this.m_localAnchor2.y,_=e.m_linearVelocity.x+-e.m_angularVelocity*m-o.m_linearVelocity.x- -o.m_angularVelocity*r,h=e.m_linearVelocity.y+e.m_angularVelocity*a-o.m_linearVelocity.y-o.m_angularVelocity*s,c=-(this.m_ptpMass.col1.x*_+this.m_ptpMass.col2.x*h),u=-(this.m_ptpMass.col1.y*_+this.m_ptpMass.col2.y*h);if(this.m_ptpImpulse.x+=c,this.m_ptpImpulse.y+=u,o.m_linearVelocity.x-=o.m_invMass*c,o.m_linearVelocity.y-=o.m_invMass*u,o.m_angularVelocity-=o.m_invI*(s*u-r*c),e.m_linearVelocity.x+=e.m_invMass*c,e.m_linearVelocity.y+=e.m_invMass*u,e.m_angularVelocity+=e.m_invI*(a*u-m*c),this.m_enableMotor&&this.m_limitState!=Z.e_equalLimits){var y=e.m_angularVelocity-o.m_angularVelocity-this.m_motorSpeed,p=-this.m_motorMass*y,x=this.m_motorImpulse;this.m_motorImpulse=n.b2Clamp(this.m_motorImpulse+p,-t.dt*this.m_maxMotorTorque,t.dt*this.m_maxMotorTorque),p=this.m_motorImpulse-x,o.m_angularVelocity-=o.m_invI*p,e.m_angularVelocity+=e.m_invI*p}if(this.m_enableLimit&&this.m_limitState!=Z.e_inactiveLimit){var d=e.m_angularVelocity-o.m_angularVelocity,f=-this.m_motorMass*d;this.m_limitState==Z.e_equalLimits?this.m_limitImpulse+=f:this.m_limitState==Z.e_atLowerLimit?(l=this.m_limitImpulse,this.m_limitImpulse=n.b2Max(this.m_limitImpulse+f,0),f=this.m_limitImpulse-l):this.m_limitState==Z.e_atUpperLimit&&(l=this.m_limitImpulse,this.m_limitImpulse=n.b2Min(this.m_limitImpulse+f,0),f=this.m_limitImpulse-l),o.m_angularVelocity-=o.m_invI*f,e.m_angularVelocity+=e.m_invI*f}},SolvePositionConstraints:function(){var i,o,e,s=this.m_body1,r=this.m_body2,l=0;e=s.m_R;var a=e.col1.x*this.m_localAnchor1.x+e.col2.x*this.m_localAnchor1.y,m=e.col1.y*this.m_localAnchor1.x+e.col2.y*this.m_localAnchor1.y;e=r.m_R;var _=e.col1.x*this.m_localAnchor2.x+e.col2.x*this.m_localAnchor2.y,h=e.col1.y*this.m_localAnchor2.x+e.col2.y*this.m_localAnchor2.y,c=s.m_position.x+a,u=s.m_position.y+m,y=r.m_position.x+_,p=r.m_position.y+h,x=y-c,d=p-u;l=Math.sqrt(x*x+d*d);var f=s.m_invMass,b=r.m_invMass,v=s.m_invI,g=r.m_invI;this.K1.col1.x=f+b,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=f+b,this.K2.col1.x=v*m*m,this.K2.col2.x=-v*a*m,this.K2.col1.y=-v*a*m,this.K2.col2.y=v*a*a,this.K3.col1.x=g*h*h,this.K3.col2.x=-g*_*h,this.K3.col1.y=-g*_*h,this.K3.col2.y=g*_*_,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(ht.tImpulse,-x,-d);var A=ht.tImpulse.x,w=ht.tImpulse.y;s.m_position.x-=s.m_invMass*A,s.m_position.y-=s.m_invMass*w,s.m_rotation-=s.m_invI*(a*w-m*A),s.m_R.Set(s.m_rotation),r.m_position.x+=r.m_invMass*A,r.m_position.y+=r.m_invMass*w,r.m_rotation+=r.m_invI*(_*w-h*A),r.m_R.Set(r.m_rotation);var S=0;if(this.m_enableLimit&&this.m_limitState!=Z.e_inactiveLimit){var V=r.m_rotation-s.m_rotation-this.m_intialAngle,M=0;this.m_limitState==Z.e_equalLimits?(o=n.b2Clamp(V,-t.b2_maxAngularCorrection,t.b2_maxAngularCorrection),M=-this.m_motorMass*o,S=n.b2Abs(o)):this.m_limitState==Z.e_atLowerLimit?(o=V-this.m_lowerAngle,S=n.b2Max(0,-o),o=n.b2Clamp(o+t.b2_angularSlop,-t.b2_maxAngularCorrection,0),M=-this.m_motorMass*o,i=this.m_limitPositionImpulse,this.m_limitPositionImpulse=n.b2Max(this.m_limitPositionImpulse+M,0),M=this.m_limitPositionImpulse-i):this.m_limitState==Z.e_atUpperLimit&&(o=V-this.m_upperAngle,S=n.b2Max(0,o),o=n.b2Clamp(o-t.b2_angularSlop,0,t.b2_maxAngularCorrection),M=-this.m_motorMass*o,i=this.m_limitPositionImpulse,this.m_limitPositionImpulse=n.b2Min(this.m_limitPositionImpulse+M,0),M=this.m_limitPositionImpulse-i),s.m_rotation-=s.m_invI*M,s.m_R.Set(s.m_rotation),r.m_rotation+=r.m_invI*M,r.m_R.Set(r.m_rotation)}return l<=t.b2_linearSlop&&S<=t.b2_angularSlop},m_localAnchor1:new i,m_localAnchor2:new i,m_ptpImpulse:new i,m_motorImpulse:null,m_limitImpulse:null,m_limitPositionImpulse:null,m_ptpMass:new o,m_motorMass:null,m_intialAngle:null,m_lowerAngle:null,m_upperAngle:null,m_maxMotorTorque:null,m_motorSpeed:null,m_enableLimit:null,m_enableMotor:null,m_limitState:0}),ht.tImpulse=new i;var ct=l.create();return Object.extend(ct.prototype,$.prototype),Object.extend(ct.prototype,{initialize:function(){this.type=Z.e_unknownJoint,this.userData=null,this.body1=null,this.body2=null,this.collideConnected=!1,this.type=Z.e_revoluteJoint,this.anchorPoint=new i(0,0),this.lowerAngle=0,this.upperAngle=0,this.motorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},anchorPoint:null,lowerAngle:null,upperAngle:null,motorTorque:null,motorSpeed:null,enableLimit:null,enableMotor:null}),[e,W,i,M,F,I,rt]},m=(o("cb29"),a()[0]),_=a()[1],h=a()[2],c=a()[3],u=a()[4],y=a()[5],p=a()[6],x=function(t){var i,o=[0,0],n=[window.screenX,window.screenY,window.innerWidth,window.innerHeight];Z();var e,s,r,l,a,x,d,f=[["#10222B","#95AB63","#BDD684","#E2F0D6","#F6FFE0"],["#362C2A","#732420","#BF734C","#FAD9A0","#736859"],["#0D1114","#102C2E","#695F4C","#EBBC5E","#FFFBB8"],["#2E2F38","#FFD63E","#FFB54B","#E88638","#8A221C"],["#121212","#E6F2DA","#C9F24B","#4D7B85","#23383D"],["#343F40","#736751","#F2D7B6","#BFAC95","#8C3F3F"],["#000000","#2D2B2A","#561812","#B81111","#FFFFFF"],["#333B3A","#B4BD51","#543B38","#61594D","#B8925A"]],b=1,v=1/15,g=[],A=200,w=!1,S=!1,V=!1,M={x:0,y:0},I={x:0,y:1},C=2*Math.PI,P=0,B=t;function R(){i=document.getElementById("canvas"),document.onmousedown=j,document.onmouseup=O,document.onmousemove=T,document.ondblclick=k,document.oncontextmenu=G,document.addEventListener("touchstart",z,!1),document.addEventListener("touchmove",E,!1),document.addEventListener("touchend",q,!1),window.addEventListener("deviceorientation",N,!1),s=new m,s.minVertex.Set(-200,-200),s.maxVertex.Set(window.innerWidth+200,window.innerHeight+200),r=new _(s,new h(0,0),!0),Y(),F(!0)}function L(){setInterval(X,25)}function F(t){if(l)for(var o=0;o<l.length;o++){var n=l[o];i.removeChild(n.GetUserData().element),r.DestroyBody(n),n=null}e=f[Math.random()*f.length>>0],document.body.style["overflow"]="hidden",l=[],a=[],U();for(var s=0;s<10;s++)K()}function J(){}function D(){setTimeout((function(){if(document.onmousedown=J,document.onmouseup=J,document.onmousemove=J,document.ondblclick=J,document.oncontextmenu=J,l)for(var t=0;t<l.length;t++){var o=l[t];i.removeChild(o.GetUserData().element),r.DestroyBody(o),o=null}document.body.style["overflow"]="auto"}),100)}function j(){return V=!0,!1}function O(){return V=!1,!1}function T(t){M.x=t.clientX,M.y=t.clientY}function k(){F()}function G(){return D(),!1}function z(t){if(1==t.touches.length){t.preventDefault();var i=(new Date).getTime();if(i-P<250)return void F();P=i,M.x=t.touches[0].pageX,M.y=t.touches[0].pageY,V=!0}}function E(t){1==t.touches.length&&(t.preventDefault(),M.x=t.touches[0].pageX,M.y=t.touches[0].pageY)}function q(t){0==t.touches.length&&(t.preventDefault(),V=!1)}function N(t){t.beta&&(I.x=Math.sin(t.gamma*Math.PI/180),I.y=Math.sin(Math.PI/4+t.beta*Math.PI/180))}function U(){var t=250,o=document.createElement("div");o.width=t,o.height=t,o.style.position="absolute",o.style.left="-200px",o.style.top="-200px",o.style.cursor="default",i.appendChild(o),a.push(o);var s=document.createElement("canvas");s.width=t,s.height=t;var m=s.getContext("2d");m.fillStyle=e[3],m.beginPath(),m.arc(.5*t,.5*t,.5*t,0,C,!0),m.closePath(),m.fill(),o.appendChild(s),x=document.createElement("div"),x.onSelectStart=null,x.innerHTML='<span style="color:'+e[0],x.style.color=e[1],x.style.position="absolute",x.style.left="0px",x.style.top="0px",x.style.fontFamily="Georgia",x.style.textAlign="center",o.appendChild(x),x.style.left=(250-x.clientWidth)/2+"px",x.style.top=(250-x.clientHeight)/2+"px";var _=new u;s=new y;s.radius=t/2,s.density=1,s.friction=.3,s.restitution=.3,_.AddShape(s),_.userData={element:o},_.position.Set(Math.random()*n[2],-200*Math.random()),_.linearVelocity.Set(400*Math.random()-200,400*Math.random()-200),l.push(r.CreateBody(_))}function K(t,o){t=t||Math.random()*n[2],o=o||-200*Math.random();var s=20+(100*Math.random()>>0),m=document.createElement("canvas");m.width=s,m.height=s,m.style.position="absolute",m.style.left="-200px",m.style.top="-200px",m.style.WebkitTransform="translateZ(0)",m.style.MozTransform="translateZ(0)",m.style.OTransform="translateZ(0)",m.style.msTransform="translateZ(0)",m.style.transform="translateZ(0)";for(var _=m.getContext("2d"),h=10*Math.random()>>0,c=s;c>0;c-=s/h)_.fillStyle=e[1+(4*Math.random()>>0)],_.beginPath(),_.arc(.5*s,.5*s,.5*c,0,C,!0),_.closePath(),_.fill();i.appendChild(m),a.push(m);var p=new u,x=new y;x.radius=s>>1,x.density=1,x.friction=.3,x.restitution=.3,p.AddShape(x),p.userData={element:m},p.position.Set(t,o),p.linearVelocity.Set(400*Math.random()-200,400*Math.random()-200),l.push(r.CreateBody(p))}function X(){Z()&&Y(),o[0]+=.5*(0-o[0]),o[1]+=.5*(0-o[1]),r.m_gravity.x=350*I.x+o[0],r.m_gravity.y=350*I.y+o[1],W(),r.Step(v,b);for(var t=0;t<l.length;t++){var i=l[t],n=a[t];if(n.style.left=i.m_position0.x-(n.width>>1)+"px",n.style.top=i.m_position0.y-(n.height>>1)+"px","DIV"==n.tagName){var e="rotate("+57.2957795*i.m_rotation0+"deg) translateZ(0)";x.style.WebkitTransform=e,x.style.MozTransform=e,x.style.OTransform=e,x.style.msTransform=e,x.style.transform=e}}}function H(t,i,o,n,e,s){"undefined"==typeof s&&(s=!0);var r=new c;s||(r.density=1),r.extents.Set(n,e);var l=new u;return l.AddShape(r),l.position.Set(i,o),t.CreateBody(l)}function W(){if(S)K(M.x,M.y);else if(V&&!d){var t=Q();if(t){var i=new p;i.body1=r.m_groundBody,i.body2=t,i.target.Set(M.x,M.y),i.maxForce=3e4*t.m_mass,d=r.CreateJoint(i),t.WakeUp()}else S=!0}if(V||(S=!1,!1,d&&(r.DestroyJoint(d),d=null)),d){var o=new h(M.x,M.y);d.SetTarget(o)}}function Q(){var t=new h;t.Set(M.x,M.y);var i=new m;i.minVertex.Set(M.x-1,M.y-1),i.maxVertex.Set(M.x+1,M.y+1);for(var o=10,n=new Array,e=r.Query(i,n,o),s=null,l=0;l<e;++l)if(0==n[l].m_body.IsStatic()&&n[l].TestPoint(t)){s=n[l].m_body;break}return s}function Y(){w&&(r.DestroyBody(g[0]),r.DestroyBody(g[1]),r.DestroyBody(g[2]),r.DestroyBody(g[3]),g[0]=null,g[1]=null,g[2]=null,g[3]=null),g[0]=H(r,n[2]/2,-A,n[2],A),g[1]=H(r,n[2]/2,n[3]+A,n[2],A),g[2]=H(r,-A,n[3]/2,A,n[3]),g[3]=H(r,n[2]+A,n[3]/2,A,n[3]),w=!0}function Z(){var t=!1;return n[0]!=window.screenX&&(o[0]=50*(window.screenX-n[0]),n[0]=window.screenX,t=!0),n[1]!=window.screenY&&(o[1]=50*(window.screenY-n[1]),n[1]=window.screenY,t=!0),n[2]!=window.innerWidth&&(n[2]=window.innerWidth,t=!0),n[3]!=window.innerHeight&&(n[3]=window.innerHeight,t=!0),t}B&&(R(),L()),B=!1},f={name:"ballAnimation",data:function(){return{isBallStart:!1}},methods:{isStartChange:function(){this.isBallStart=!this.isBallStart,x(this.isBallStart),this.isBallStart=!this.isBallStart},isExitGame:function(){document.oncontextmenu=none}},created:function(){document.body.className="body"},mounted:function(){r(),a(),x(this.isBallStart)}},b=f,v=(o("e8f8"),o("2877")),g=Object(v["a"])(b,n,e,!1,null,null,null);i["default"]=g.exports},7156:function(t,i,o){var n=o("861d"),e=o("d2bb");t.exports=function(t,i,o){var s,r;return e&&"function"==typeof(s=i.constructor)&&s!==o&&n(r=s.prototype)&&r!==o.prototype&&e(t,r),t}},"746f":function(t,i,o){var n=o("428f"),e=o("5135"),s=o("e538"),r=o("9bf2").f;t.exports=function(t){var i=n.Symbol||(n.Symbol={});e(i,t)||r(i,t,{value:s.f(t)})}},"81d5":function(t,i,o){"use strict";var n=o("7b0b"),e=o("23cb"),s=o("50c4");t.exports=function(t){var i=n(this),o=s(i.length),r=arguments.length,l=e(r>1?arguments[1]:void 0,o),a=r>2?arguments[2]:void 0,m=void 0===a?o:e(a,o);while(m>l)i[l++]=t;return i}},8418:function(t,i,o){"use strict";var n=o("c04e"),e=o("9bf2"),s=o("5c6c");t.exports=function(t,i,o){var r=n(i);r in t?e.f(t,r,s(0,o)):t[r]=o}},"96e1":function(t,i,o){},a15b:function(t,i,o){"use strict";var n=o("23e7"),e=o("44ad"),s=o("fc6a"),r=o("a640"),l=[].join,a=e!=Object,m=r("join",",");n({target:"Array",proto:!0,forced:a||!m},{join:function(t){return l.call(s(this),void 0===t?",":t)}})},a434:function(t,i,o){"use strict";var n=o("23e7"),e=o("23cb"),s=o("a691"),r=o("50c4"),l=o("7b0b"),a=o("65f0"),m=o("8418"),_=o("1dde"),h=_("splice"),c=Math.max,u=Math.min,y=9007199254740991,p="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!h},{splice:function(t,i){var o,n,_,h,x,d,f=l(this),b=r(f.length),v=e(t,b),g=arguments.length;if(0===g?o=n=0:1===g?(o=0,n=b-v):(o=g-2,n=u(c(s(i),0),b-v)),b+o-n>y)throw TypeError(p);for(_=a(f,n),h=0;h<n;h++)x=v+h,x in f&&m(_,h,f[x]);if(_.length=n,o<n){for(h=v;h<b-n;h++)x=h+n,d=h+o,x in f?f[d]=f[x]:delete f[d];for(h=b;h>b-n+o;h--)delete f[h-1]}else if(o>n)for(h=b-n;h>v;h--)x=h+n-1,d=h+o-1,x in f?f[d]=f[x]:delete f[d];for(h=0;h<o;h++)f[h+v]=arguments[h+2];return f.length=b-n+o,_}})},a4d3:function(t,i,o){"use strict";var n=o("23e7"),e=o("da84"),s=o("d066"),r=o("c430"),l=o("83ab"),a=o("4930"),m=o("fdbf"),_=o("d039"),h=o("5135"),c=o("e8b5"),u=o("861d"),y=o("825a"),p=o("7b0b"),x=o("fc6a"),d=o("c04e"),f=o("5c6c"),b=o("7c73"),v=o("df75"),g=o("241c"),A=o("057f"),w=o("7418"),S=o("06cf"),V=o("9bf2"),M=o("d1e7"),I=o("9112"),C=o("6eeb"),P=o("5692"),B=o("f772"),R=o("d012"),L=o("90e3"),F=o("b622"),J=o("e538"),D=o("746f"),j=o("d44e"),O=o("69f3"),T=o("b727").forEach,k=B("hidden"),G="Symbol",z="prototype",E=F("toPrimitive"),q=O.set,N=O.getterFor(G),U=Object[z],K=e.Symbol,X=s("JSON","stringify"),H=S.f,W=V.f,Q=A.f,Y=M.f,Z=P("symbols"),$=P("op-symbols"),tt=P("string-to-symbol-registry"),it=P("symbol-to-string-registry"),ot=P("wks"),nt=e.QObject,et=!nt||!nt[z]||!nt[z].findChild,st=l&&_((function(){return 7!=b(W({},"a",{get:function(){return W(this,"a",{value:7}).a}})).a}))?function(t,i,o){var n=H(U,i);n&&delete U[i],W(t,i,o),n&&t!==U&&W(U,i,n)}:W,rt=function(t,i){var o=Z[t]=b(K[z]);return q(o,{type:G,tag:t,description:i}),l||(o.description=i),o},lt=m?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof K},at=function(t,i,o){t===U&&at($,i,o),y(t);var n=d(i,!0);return y(o),h(Z,n)?(o.enumerable?(h(t,k)&&t[k][n]&&(t[k][n]=!1),o=b(o,{enumerable:f(0,!1)})):(h(t,k)||W(t,k,f(1,{})),t[k][n]=!0),st(t,n,o)):W(t,n,o)},mt=function(t,i){y(t);var o=x(i),n=v(o).concat(yt(o));return T(n,(function(i){l&&!ht.call(o,i)||at(t,i,o[i])})),t},_t=function(t,i){return void 0===i?b(t):mt(b(t),i)},ht=function(t){var i=d(t,!0),o=Y.call(this,i);return!(this===U&&h(Z,i)&&!h($,i))&&(!(o||!h(this,i)||!h(Z,i)||h(this,k)&&this[k][i])||o)},ct=function(t,i){var o=x(t),n=d(i,!0);if(o!==U||!h(Z,n)||h($,n)){var e=H(o,n);return!e||!h(Z,n)||h(o,k)&&o[k][n]||(e.enumerable=!0),e}},ut=function(t){var i=Q(x(t)),o=[];return T(i,(function(t){h(Z,t)||h(R,t)||o.push(t)})),o},yt=function(t){var i=t===U,o=Q(i?$:x(t)),n=[];return T(o,(function(t){!h(Z,t)||i&&!h(U,t)||n.push(Z[t])})),n};if(a||(K=function(){if(this instanceof K)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,i=L(t),o=function(t){this===U&&o.call($,t),h(this,k)&&h(this[k],i)&&(this[k][i]=!1),st(this,i,f(1,t))};return l&&et&&st(U,i,{configurable:!0,set:o}),rt(i,t)},C(K[z],"toString",(function(){return N(this).tag})),C(K,"withoutSetter",(function(t){return rt(L(t),t)})),M.f=ht,V.f=at,S.f=ct,g.f=A.f=ut,w.f=yt,J.f=function(t){return rt(F(t),t)},l&&(W(K[z],"description",{configurable:!0,get:function(){return N(this).description}}),r||C(U,"propertyIsEnumerable",ht,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!a,sham:!a},{Symbol:K}),T(v(ot),(function(t){D(t)})),n({target:G,stat:!0,forced:!a},{for:function(t){var i=String(t);if(h(tt,i))return tt[i];var o=K(i);return tt[i]=o,it[o]=i,o},keyFor:function(t){if(!lt(t))throw TypeError(t+" is not a symbol");if(h(it,t))return it[t]},useSetter:function(){et=!0},useSimple:function(){et=!1}}),n({target:"Object",stat:!0,forced:!a,sham:!l},{create:_t,defineProperty:at,defineProperties:mt,getOwnPropertyDescriptor:ct}),n({target:"Object",stat:!0,forced:!a},{getOwnPropertyNames:ut,getOwnPropertySymbols:yt}),n({target:"Object",stat:!0,forced:_((function(){w.f(1)}))},{getOwnPropertySymbols:function(t){return w.f(p(t))}}),X){var pt=!a||_((function(){var t=K();return"[null]"!=X([t])||"{}"!=X({a:t})||"{}"!=X(Object(t))}));n({target:"JSON",stat:!0,forced:pt},{stringify:function(t,i,o){var n,e=[t],s=1;while(arguments.length>s)e.push(arguments[s++]);if(n=i,(u(i)||void 0!==t)&&!lt(t))return c(i)||(i=function(t,i){if("function"==typeof n&&(i=n.call(this,t,i)),!lt(i))return i}),e[1]=i,X.apply(null,e)}})}K[z][E]||I(K[z],E,K[z].valueOf),j(K,G),R[k]=!0},a640:function(t,i,o){"use strict";var n=o("d039");t.exports=function(t,i){var o=[][t];return!!o&&n((function(){o.call(null,i||function(){throw 1},1)}))}},a9e3:function(t,i,o){"use strict";var n=o("83ab"),e=o("da84"),s=o("94ca"),r=o("6eeb"),l=o("5135"),a=o("c6b6"),m=o("7156"),_=o("c04e"),h=o("d039"),c=o("7c73"),u=o("241c").f,y=o("06cf").f,p=o("9bf2").f,x=o("58a8").trim,d="Number",f=e[d],b=f.prototype,v=a(c(b))==d,g=function(t){var i,o,n,e,s,r,l,a,m=_(t,!1);if("string"==typeof m&&m.length>2)if(m=x(m),i=m.charCodeAt(0),43===i||45===i){if(o=m.charCodeAt(2),88===o||120===o)return NaN}else if(48===i){switch(m.charCodeAt(1)){case 66:case 98:n=2,e=49;break;case 79:case 111:n=8,e=55;break;default:return+m}for(s=m.slice(2),r=s.length,l=0;l<r;l++)if(a=s.charCodeAt(l),a<48||a>e)return NaN;return parseInt(s,n)}return+m};if(s(d,!f(" 0o1")||!f("0b1")||f("+0x1"))){for(var A,w=function(t){var i=arguments.length<1?0:t,o=this;return o instanceof w&&(v?h((function(){b.valueOf.call(o)})):a(o)!=d)?m(new f(g(i)),o,w):g(i)},S=n?u(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),V=0;S.length>V;V++)l(f,A=S[V])&&!l(w,A)&&p(w,A,y(f,A));w.prototype=b,b.constructor=w,r(e,d,w)}},ad6d:function(t,i,o){"use strict";var n=o("825a");t.exports=function(){var t=n(this),i="";return t.global&&(i+="g"),t.ignoreCase&&(i+="i"),t.multiline&&(i+="m"),t.dotAll&&(i+="s"),t.unicode&&(i+="u"),t.sticky&&(i+="y"),i}},b64b:function(t,i,o){var n=o("23e7"),e=o("7b0b"),s=o("df75"),r=o("d039"),l=r((function(){s(1)}));n({target:"Object",stat:!0,forced:l},{keys:function(t){return s(e(t))}})},b727:function(t,i,o){var n=o("0366"),e=o("44ad"),s=o("7b0b"),r=o("50c4"),l=o("65f0"),a=[].push,m=function(t){var i=1==t,o=2==t,m=3==t,_=4==t,h=6==t,c=7==t,u=5==t||h;return function(y,p,x,d){for(var f,b,v=s(y),g=e(v),A=n(p,x,3),w=r(g.length),S=0,V=d||l,M=i?V(y,w):o||c?V(y,0):void 0;w>S;S++)if((u||S in g)&&(f=g[S],b=A(f,S,v),t))if(i)M[S]=b;else if(b)switch(t){case 3:return!0;case 5:return f;case 6:return S;case 2:a.call(M,f)}else switch(t){case 4:return!1;case 7:a.call(M,f)}return h?-1:m||_?_:M}};t.exports={forEach:m(0),map:m(1),filter:m(2),some:m(3),every:m(4),find:m(5),findIndex:m(6),filterOut:m(7)}},bf19:function(t,i,o){"use strict";var n=o("23e7");n({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},cb29:function(t,i,o){var n=o("23e7"),e=o("81d5"),s=o("44d2");n({target:"Array",proto:!0},{fill:e}),s("fill")},d28b:function(t,i,o){var n=o("746f");n("iterator")},e01a:function(t,i,o){"use strict";var n=o("23e7"),e=o("83ab"),s=o("da84"),r=o("5135"),l=o("861d"),a=o("9bf2").f,m=o("e893"),_=s.Symbol;if(e&&"function"==typeof _&&(!("description"in _.prototype)||void 0!==_().description)){var h={},c=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),i=this instanceof c?new _(t):void 0===t?_():_(t);return""===t&&(h[i]=!0),i};m(c,_);var u=c.prototype=_.prototype;u.constructor=c;var y=u.toString,p="Symbol(test)"==String(_("test")),x=/^Symbol\((.*)\)[^)]+$/;a(u,"description",{configurable:!0,get:function(){var t=l(this)?this.valueOf():this,i=y.call(t);if(r(h,t))return"";var o=p?i.slice(7,-1):i.replace(x,"$1");return""===o?void 0:o}}),n({global:!0,forced:!0},{Symbol:c})}},e538:function(t,i,o){var n=o("b622");i.f=n},e8b5:function(t,i,o){var n=o("c6b6");t.exports=Array.isArray||function(t){return"Array"==n(t)}},e8f8:function(t,i,o){"use strict";o("96e1")}}]);
//# sourceMappingURL=chunk-65f546f0.40a30051.js.map